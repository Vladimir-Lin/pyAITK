# -*- coding: utf-8 -*-
##############################################################################
## JSON工具程式
##############################################################################
import os
import sys
import time
import datetime
import json
##############################################################################
## 從檔案中載入JSON
##############################################################################
def Load                     ( Filename                                    ) :
  ############################################################################
  if                         ( not os . path . isfile ( Filename )         ) :
    return { }
  ############################################################################
  TEXT     = ""
  with open                  ( Filename , "rb" ) as jsonFile                 :
    TEXT   = jsonFile . read (                                               )
  ############################################################################
  if                         ( len ( TEXT ) <= 0                           ) :
    return { }
  ############################################################################
  BODY     = TEXT . decode   ( "utf-8"                                       )
  if                         ( len ( BODY ) <= 0                           ) :
    return { }
  ############################################################################
  return json . loads        ( BODY                                          )
##############################################################################
## 儲存JSON到檔案中
##############################################################################
def Save              ( Filename , Main                                    ) :
  S   = json . dumps  ( Main , ensure_ascii = False , indent = 4             )
  B   = S    . encode ( "utf-8"                                              )
  with open ( Filename , 'wb' ) as f                                         :
    f . write         ( B                                                    )
  return True
##############################################################################
## 合併兩個JSON
##############################################################################
def Merge                    ( Main , After , Ignore = [ ]                 ) :
  ############################################################################
  if                         ( len ( After ) <= 0                          ) :
    return Main
  ############################################################################
  KEYs = After . keys        (                                               )
  if                         ( len ( KEYs ) <= 0                           ) :
    return Main
  ############################################################################
  for k in KEYs                                                              :
    if                       ( k not in Ignore                             ) :
      Main [ k ] = After [ k ]
  ############################################################################
  return Main
##############################################################################
## 載入兩個JSON，並且進行合併
##############################################################################
def LoadBoth                 ( MainFile , AfterFile , Ignore = [ ]         ) :
  ############################################################################
  MainJson  = Load           ( MainFile                                      )
  AfterJson = Load           ( AfterFile                                     )
  ############################################################################
  return Merge               ( MainJson , AfterJson , Ignore                 )
##############################################################################
