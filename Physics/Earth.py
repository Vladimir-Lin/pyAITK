# -*- coding: utf-8 -*-
##############################################################################
## 地球元件
##############################################################################
import math
import datetime
import pytz
##############################################################################
import gmpy2
from   gmpy2                             import mpz
from   gmpy2                             import mpq
from   gmpy2                             import mpfr
##############################################################################
from   AITK . Calendars . StarDate       import StarDate
from   AITK . Calendars . Periode        import Periode
##############################################################################
from   AITK . Physics                    import JulianDayToJulianCentury as JulianDayToJulianCentury
from   AITK . Physics   . PlanetSpot     import PlanetSpot               as PlanetSpot
from   AITK . Physics   . Sun            import Sun                      as Sun
##############################################################################
from   sunpy   . coordinates . ephemeris import get_body_heliographic_stonyhurst
from   astropy . time                    import Time                     as AstroTime
##############################################################################
Requator           = mpfr ( "6378137.0"    , 1024                            )
Rpoles             = mpfr ( "6356752.3"    , 1024                            )
Raverage           = mpfr ( "6371000.0"    , 1024                            )
##############################################################################
Sminute            = mpfr ( "60.0"         , 1024                            )
TwoCircle          = mpfr ( "720.0"        , 1024                            )
ThreeCircle        = mpfr ( "1080.0"       , 1024                            )
##############################################################################
## 地球離心率
##############################################################################
Eccentricity       = mpfr ( "0.016708634"  , 1024                            )
Eb                 = mpfr ( "0.000042037"  , 1024                            )
Ec                 = mpfr ( "0.0000001267" , 1024                            )
##############################################################################
## 平近點角
##############################################################################
SUNmeanAnomaly     = mpfr ( "357.52911"    , 1024                            )
SUNmab             = mpfr ( "35999.05029"  , 1024                            )
SUNmac             = mpfr ( "0.0001537"    , 1024                            )
##############################################################################
## 平黃經
##############################################################################
SUNmeanLongitude   = mpfr ( "280.46646"    , 1024                            )
SUNmlb             = mpfr ( "36000.76983"  , 1024                            )
SUNmlc             = mpfr ( "0.0003032"    , 1024                            )
##############################################################################
## 太陽校正角參數
##############################################################################
SUNcsin1mb         = mpfr ( "1.914602"     , 1024                            )
SUNcsin1mc         = mpfr ( "0.004817"     , 1024                            )
SUNcsin1md         = mpfr ( "0.000014"     , 1024                            )
SUNcsin2mb         = mpfr ( "0.019993"     , 1024                            )
SUNcsin2mc         = mpfr ( "0.000101"     , 1024                            )
SUNcsin3m          = mpfr ( "0.000289"     , 1024                            )
##############################################################################
## 太陽角向量參數
##############################################################################
SUNradVector       = mpfr ( "1.000001018"  , 1024                            )
##############################################################################
## 太陽Omega參數
##############################################################################
SUNomegab          = mpfr ( "125.04"       , 1024                            )
SUNomegac          = mpfr ( "1934.136"     , 1024                            )
##############################################################################
## 太陽視經度參數
##############################################################################
SUNapparentLa      = mpfr ( "0.00569"      , 1024                            )
SUNapparentLb      = mpfr ( "0.00478"      , 1024                            )
##############################################################################
## 黃道平均傾角參數
##############################################################################
SUNmoeA            = mpfr ( "21.448"       , 1024                            )
SUNmoeB            = mpfr ( "46.815"       , 1024                            )
SUNmoeC            = mpfr ( "0.00059"      , 1024                            )
SUNmoeD            = mpfr ( "0.001813"     , 1024                            )
SUNmoeE            = mpfr ( "23.0"         , 1024                            )
SUNmoeF            = mpfr ( "26.0"         , 1024                            )
##############################################################################
## 黃道平均傾角校正參數
##############################################################################
SUNobc             = mpfr ( "0.00256"      , 1024                            )
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
SunEarthPerihelions = [ 1420092378682678320                                  ,
                        1420092378714060540                                  ,
                        1420092378745736520                                  ,
                        1420092378777318120                                  ,
                        1420092378808706100                                  ,
                        1420092378840468600                                  ,
                        1420092378871933380                                  ,
                        1420092378903397860                                  ,
                        1420092378935163000                                  ,
                        1420092378966557340                                  ,
                        1420092378998159520                                  ,
                        1420092379029803520                                  ,
                        1420092379061181480                                  ,
                        1420092379092916740                                  ,
                        1420092379124433360                                  ,
                        1420092379155854940                                  ,
                        1420092379187619480                                  ,
                        1420092379219037700                                  ,
                        1420092379250572800                                  ,
                        1420092379282290480                                  ,
                        1420092379313675460                                  ,
                        1420092379345359300                                  ,
                        1420092379376929020                                  ,
                        1420092379408322340                                  ,
                        1420092379440077280                                  ,
                        1420092379471540560                                  ,
                        1420092379503023580                                  ,
                        1420092379534768080                                  ,
                        1420092379566151980                                  ,
                        1420092379597745520                                  ,
                        1420092379629406080                                  ,
                        1420092379660799460                                  ,
                        1420092379692532260                                  ,
                        1420092379724042820                                  ,
                        1420092379755478440                                  ,
                        1420092379787235420                                  ,
                        1420092379818648000                                  ,
                        1420092379850187660                                  ,
                        1420092379881902460                                  ,
                        1420092379913283180                                  ,
                        1420092379944942720                                  ,
                        1420092379976519220                                  ,
                        1420092380007929700                                  ,
                        1420092380039691120                                  ,
                        1420092380071148160                                  ,
                        1420092380102633880                                  ,
                        1420092380134381440                                  ,
                        1420092380165767500                                  ,
                        1420092380197362420                                  ,
                        1420092380229017700                                  ,
                        1420092380260416720                                  ,
                        1420092380292139080                                  ,
                        1420092380323635480                                  ,
                        1420092380355069540                                  ,
                        1420092380386844640                                  ,
                        1420092380418263040                                  ,
                        1420092380449797060                                  ,
                        1420092380481508800                                  ,
                        1420092380512896240                                  ,
                        1420092380544562560                                  ,
                        1420092380576129580                                  ,
                        1420092380607542160                                  ,
                        1420092380639310060                                  ,
                        1420092380670753240                                  ,
                        1420092380702214600                                  ,
                        1420092380733975900                                  ,
                        1420092380765379900                                  ,
                        1420092380796992940                                  ,
                        1420092380828629500                                  ,
                        1420092380860023060                                  ,
                        1420092380891756640                                  ,
                        1420092380923246920                                  ,
                        1420092380954673660                                  ,
                        1420092380986457100                                  ,
                        1420092381017873640                                  ,
                        1420092381049399980                                  ,
                        1420092381081099180                                  ,
                        1420092381112489380                                  ,
                        1420092381144183300                                  ,
                        1420092381175746900                                  ,
                        1420092381207149760                                  ,
                        1420092381238926660                                  ,
                        1420092381270367680                                  ,
                        1420092381301836540                                  ,
                        1420092381333587580                                  ,
                        1420092381364989720                                  ,
                        1420092381396616680                                  ,
                        1420092381428233140                                  ,
                        1420092381459603660                                  ,
                        1420092381491354700                                  ,
                        1420092381522856920                                  ,
                        1420092381554292540                                  ,
                        1420092381586068960                                  ,
                        1420092381617482620                                  ,
                        1420092381649031760                                  ,
                        1420092381680718960                                  ,
                        1420092381712092720                                  ,
                        1420092381743807640                                  ,
                        1420092381775357080                                  ,
                        1420092381806747640                                  ]
##############################################################################
EarthPerihelionDistances = [ 147097491889                                    ,
                             147098060361                                    ,
                             147102638056                                    ,
                             147094320414                                    ,
                             147099107546                                    ,
                             147103625402                                    ,
                             147093632264                                    ,
                             147096609262                                    ,
                             147095547117                                    ,
                             147098045401                                    ,
                             147105764651                                    ,
                             147097207653                                    ,
                             147098165080                                    ,
                             147104777305                                    ,
                             147096205347                                    ,
                             147100169691                                    ,
                             147100992479                                    ,
                             147097237573                                    ,
                             147099765777                                    ,
                             147091148939                                    ,
                             147093168511                                    ,
                             147105046582                                    ,
                             147098928029                                    ,
                             147100633444                                    ,
                             147103685241                                    ,
                             147099900415                                    ,
                             147104597788                                    ,
                             147100693284                                    ,
                             147098344597                                    ,
                             147105839450                                    ,
                             147094559771                                    ,
                             147091642612                                    ,
                             147099421702                                    ,
                             147097985562                                    ,
                             147103311246                                    ,
                             147102608136                                    ,
                             147097925723                                    ,
                             147107799182                                    ,
                             147101276715                                    ,
                             147098643793                                    ,
                             147106632319                                    ,
                             147099795696                                    ,
                             147097821004                                    ,
                             147098030441                                    ,
                             147094395213                                    ,
                             147106333123                                    ,
                             147102817573                                    ,
                             147096863578                                    ,
                             147104702506                                    ,
                             147100483847                                    ,
                             147100334249                                    ,
                             147104971783                                    ,
                             147099586259                                    ,
                             147104971783                                    ,
                             147100468887                                    ,
                             147092255964                                    ,
                             147103595482                                    ,
                             147103804919                                    ,
                             147101456233                                    ,
                             147106692158                                    ,
                             147099885455                                    ,
                             147105285938                                    ,
                             147106407922                                    ,
                             147097297412                                    ,
                             147105211139                                    ,
                             147102219182                                    ,
                             147093333068                                    ,
                             147101157037                                    ,
                             147098419396                                    ,
                             147105555214                                    ,
                             147109983311                                    ,
                             147099152425                                    ,
                             147105899289                                    ,
                             147107649585                                    ,
                             147099451621                                    ,
                             147106916555                                    ,
                             147102069584                                    ,
                             147100349208                                    ,
                             147102982131                                    ,
                             147092914194                                    ,
                             147101441273                                    ,
                             147108906207                                    ,
                             147100109852                                    ,
                             147105959129                                    ,
                             147104508029                                    ,
                             147103460844                                    ,
                             147110806100                                    ,
                             147101665670                                    ,
                             147104478110                                    ,
                             147109130603                                    ,
                             147094769208                                    ,
                             147100394088                                    ,
                             147104148994                                    ,
                             147102742774                                    ,
                             147110237628                                    ,
                             147100753123                                    ,
                             147102518378                                    ,
                             147112541435                                    ,
                             147100798002                                    ,
                             147105540255                                    ]
##############################################################################
SunEarthAphelions = [ 1420092378698333820                                    ,
                      1420092378730007220                                    ,
                      1420092378761377200                                    ,
                      1420092378793104840                                    ,
                      1420092378824619480                                    ,
                      1420092378856048200                                    ,
                      1420092378887845980                                    ,
                      1420092378919237260                                    ,
                      1420092378950751600                                    ,
                      1420092378982495800                                    ,
                      1420092379013871240                                    ,
                      1420092379045539120                                    ,
                      1420092379077115440                                    ,
                      1420092379108512780                                    ,
                      1420092379140291600                                    ,
                      1420092379171729440                                    ,
                      1420092379203192660                                    ,
                      1420092379234975620                                    ,
                      1420092379266358260                                    ,
                      1420092379297942500                                    ,
                      1420092379329604020                                    ,
                      1420092379360998660                                    ,
                      1420092379392754020                                    ,
                      1420092379424235960                                    ,
                      1420092379455652500                                    ,
                      1420092379487439060                                    ,
                      1420092379518843960                                    ,
                      1420092379550355480                                    ,
                      1420092379582089120                                    ,
                      1420092379613480280                                    ,
                      1420092379645168200                                    ,
                      1420092379676721240                                    ,
                      1420092379708116720                                    ,
                      1420092379739904540                                    ,
                      1420092379771352520                                    ,
                      1420092379802812620                                    ,
                      1420092379834574700                                    ,
                      1420092379865965560                                    ,
                      1420092379897565100                                    ,
                      1420092379929207720                                    ,
                      1420092379960594680                                    ,
                      1420092379992345000                                    ,
                      1420092380023842300                                    ,
                      1420092380055252240                                    ,
                      1420092380087038260                                    ,
                      1420092380118463560                                    ,
                      1420092380150001120                                    ,
                      1420092380181704880                                    ,
                      1420092380213082360                                    ,
                      1420092380244765420                                    ,
                      1420092380276331840                                    ,
                      1420092380307717480                                    ,
                      1420092380339497800                                    ,
                      1420092380370958860                                    ,
                      1420092380402427120                                    ,
                      1420092380434179240                                    ,
                      1420092380465570460                                    ,
                      1420092380497189320                                    ,
                      1420092380528832300                                    ,
                      1420092380560201140                                    ,
                      1420092380591940000                                    ,
                      1420092380623448820                                    ,
                      1420092380654868060                                    ,
                      1420092380686647360                                    ,
                      1420092380718063420                                    ,
                      1420092380749599780                                    ,
                      1420092380781313980                                    ,
                      1420092380812680420                                    ,
                      1420092380844371700                                    ,
                      1420092380875953660                                    ,
                      1420092380907348000                                    ,
                      1420092380939117160                                    ,
                      1420092380970557580                                    ,
                      1420092381002019900                                    ,
                      1420092381033787380                                    ,
                      1420092381065167140                                    ,
                      1420092381096785400                                    ,
                      1420092381128441940                                    ,
                      1420092381159811560                                    ,
                      1420092381191553660                                    ,
                      1420092381223056360                                    ,
                      1420092381254487720                                    ,
                      1420092381286278840                                    ,
                      1420092381317668980                                    ,
                      1420092381349200840                                    ,
                      1420092381380924340                                    ,
                      1420092381412289160                                    ,
                      1420092381443983860                                    ,
                      1420092381475552500                                    ,
                      1420092381506944140                                    ,
                      1420092381538731300                                    ,
                      1420092381570155820                                    ,
                      1420092381601632060                                    ,
                      1420092381633415620                                    ,
                      1420092381664789740                                    ,
                      1420092381696413940                                    ,
                      1420092381728045040                                    ,
                      1420092381759410580                                    ,
                      1420092381791174880                                    ,
                      1420092381822652680                                    ]
##############################################################################
EarthAphelionDistances = [ 152087568223                                      ,
                           152094389886                                      ,
                           152100373801                                      ,
                           152095212674                                      ,
                           152102378412                                      ,
                           152095751226                                      ,
                           152097037768                                      ,
                           152104158627                                      ,
                           152091128652                                      ,
                           152096454336                                      ,
                           152102198895                                      ,
                           152092430154                                      ,
                           152097426723                                      ,
                           152093402540                                      ,
                           152093477339                                      ,
                           152103769672                                      ,
                           152092504953                                      ,
                           152095571709                                      ,
                           152104278305                                      ,
                           152095302433                                      ,
                           152100523399                                      ,
                           152098458948                                      ,
                           152093252942                                      ,
                           152099969886                                      ,
                           152087732781                                      ,
                           152087777660                                      ,
                           152100478519                                      ,
                           152093133264                                      ,
                           152098055034                                      ,
                           152099551012                                      ,
                           152094389886                                      ,
                           152103784632                                      ,
                           152095197714                                      ,
                           152091712084                                      ,
                           152102228814                                      ,
                           152090664899                                      ,
                           152090934175                                      ,
                           152094793800                                      ,
                           152089991708                                      ,
                           152100209243                                      ,
                           152094464685                                      ,
                           152089483076                                      ,
                           152102752407                                      ,
                           152095556749                                      ,
                           152094479645                                      ,
                           152100119484                                      ,
                           152092086079                                      ,
                           152097232245                                      ,
                           152091996320                                      ,
                           152085458893                                      ,
                           152099925007                                      ,
                           152095437071                                      ,
                           152091338089                                      ,
                           152099012460                                      ,
                           152093208063                                      ,
                           152097740878                                      ,
                           152096289779                                      ,
                           152087523344                                      ,
                           152098743184                                      ,
                           152092774229                                      ,
                           152085324255                                      ,
                           152095167795                                      ,
                           152092654551                                      ,
                           152095706347                                      ,
                           152096948009                                      ,
                           152088690207                                      ,
                           152100224203                                      ,
                           152097890476                                      ,
                           152088944523                                      ,
                           152097307044                                      ,
                           152092086079                                      ,
                           152089034282                                      ,
                           152090739698                                      ,
                           152084755783                                      ,
                           152095930744                                      ,
                           152097995194                                      ,
                           152088600448                                      ,
                           152098040074                                      ,
                           152097172406                                      ,
                           152093073425                                      ,
                           152096409457                                      ,
                           152089213799                                      ,
                           152093387580                                      ,
                           152093881253                                      ,
                           152083065327                                      ,
                           152092086079                                      ,
                           152095078036                                      ,
                           152089303558                                      ,
                           152093641896                                      ,
                           152089453156                                      ,
                           152093671816                                      ,
                           152098354229                                      ,
                           152089124041                                      ,
                           152094374926                                      ,
                           152095766186                                      ,
                           152085802968                                      ,
                           152089094121                                      ,
                           152087657982                                      ,
                           152090425542                                      ,
                           152096559055                                      ]
##############################################################################
EquinoxAngles       = [ 1420092378689175060                                  ,
                        1420092378697189080                                  ,
                        1420092378705279900                                  ,
                        1420092378713042520                                  ,
                        1420092378720731760                                  ,
                        1420092378728745900                                  ,
                        1420092378736836960                                  ,
                        1420092378744599700                                  ,
                        1420092378752288400                                  ,
                        1420092378760302660                                  ,
                        1420092378768394020                                  ,
                        1420092378776156640                                  ,
                        1420092378783845340                                  ,
                        1420092378791859420                                  ,
                        1420092378799950600                                  ,
                        1420092378807712920                                  ,
                        1420092378815402040                                  ,
                        1420092378823416360                                  ,
                        1420092378831507780                                  ,
                        1420092378839270100                                  ,
                        1420092378846959100                                  ,
                        1420092378854972760                                  ,
                        1420092378863064240                                  ,
                        1420092378870826920                                  ,
                        1420092378878515620                                  ,
                        1420092378886529160                                  ,
                        1420092378894621060                                  ,
                        1420092378902383680                                  ,
                        1420092378910072140                                  ,
                        1420092378918086400                                  ,
                        1420092378926178300                                  ,
                        1420092378933941040                                  ,
                        1420092378941629440                                  ,
                        1420092378949643100                                  ,
                        1420092378957734280                                  ,
                        1420092378965497620                                  ,
                        1420092378973186320                                  ,
                        1420092378981199680                                  ,
                        1420092378989291340                                  ,
                        1420092378997054680                                  ,
                        1420092379004743260                                  ,
                        1420092379012756560                                  ,
                        1420092379020848700                                  ,
                        1420092379028611800                                  ,
                        1420092379036300500                                  ,
                        1420092379044313680                                  ,
                        1420092379052405340                                  ,
                        1420092379060168320                                  ,
                        1420092379067857320                                  ,
                        1420092379075871040                                  ,
                        1420092379083962640                                  ,
                        1420092379091725860                                  ,
                        1420092379099414620                                  ,
                        1420092379107427920                                  ,
                        1420092379115519400                                  ,
                        1420092379123282980                                  ,
                        1420092379130971500                                  ,
                        1420092379138984680                                  ,
                        1420092379147076400                                  ,
                        1420092379154839680                                  ,
                        1420092379162528260                                  ,
                        1420092379170542100                                  ,
                        1420092379178634060                                  ,
                        1420092379186397100                                  ,
                        1420092379194085740                                  ,
                        1420092379202099100                                  ,
                        1420092379210190520                                  ,
                        1420092379217953740                                  ,
                        1420092379225642500                                  ,
                        1420092379233655620                                  ,
                        1420092379241747640                                  ,
                        1420092379249510920                                  ,
                        1420092379257199080                                  ,
                        1420092379265212440                                  ,
                        1420092379273305000                                  ,
                        1420092379281068340                                  ,
                        1420092379288756200                                  ,
                        1420092379296769380                                  ,
                        1420092379304861460                                  ,
                        1420092379312624980                                  ,
                        1420092379320313020                                  ,
                        1420092379328326320                                  ,
                        1420092379336418460                                  ,
                        1420092379344182340                                  ,
                        1420092379351870380                                  ,
                        1420092379359882840                                  ,
                        1420092379367975040                                  ,
                        1420092379375739280                                  ,
                        1420092379383427500                                  ,
                        1420092379391439480                                  ,
                        1420092379399531800                                  ,
                        1420092379407295680                                  ,
                        1420092379414984020                                  ,
                        1420092379422996660                                  ,
                        1420092379431089040                                  ,
                        1420092379438852800                                  ,
                        1420092379446541320                                  ,
                        1420092379454553720                                  ,
                        1420092379462645200                                  ,
                        1420092379470409380                                  ,
                        1420092379478097960                                  ,
                        1420092379486110300                                  ,
                        1420092379494201960                                  ,
                        1420092379501966200                                  ,
                        1420092379509654300                                  ,
                        1420092379517667060                                  ,
                        1420092379525759320                                  ,
                        1420092379533523380                                  ,
                        1420092379541211420                                  ,
                        1420092379549224120                                  ,
                        1420092379557315900                                  ,
                        1420092379565079600                                  ,
                        1420092379572768060                                  ,
                        1420092379580780880                                  ,
                        1420092379588873020                                  ,
                        1420092379596636840                                  ,
                        1420092379604325060                                  ,
                        1420092379612337460                                  ,
                        1420092379620430020                                  ,
                        1420092379628194140                                  ,
                        1420092379635882060                                  ,
                        1420092379643894220                                  ,
                        1420092379651986900                                  ,
                        1420092379659750960                                  ,
                        1420092379667438580                                  ,
                        1420092379675451340                                  ,
                        1420092379683544260                                  ,
                        1420092379691308620                                  ,
                        1420092379698996180                                  ,
                        1420092379707008460                                  ,
                        1420092379715100720                                  ,
                        1420092379722865500                                  ,
                        1420092379730553480                                  ,
                        1420092379738565100                                  ,
                        1420092379746657660                                  ,
                        1420092379754422500                                  ,
                        1420092379762110180                                  ,
                        1420092379770121980                                  ,
                        1420092379778215140                                  ,
                        1420092379785979860                                  ,
                        1420092379793667720                                  ,
                        1420092379801679460                                  ,
                        1420092379809771780                                  ,
                        1420092379817536320                                  ,
                        1420092379825224600                                  ,
                        1420092379833236520                                  ,
                        1420092379841328780                                  ,
                        1420092379849093680                                  ,
                        1420092379856781600                                  ,
                        1420092379864793340                                  ,
                        1420092379872885720                                  ,
                        1420092379880650860                                  ,
                        1420092379888338720                                  ,
                        1420092379896350280                                  ,
                        1420092379904442600                                  ,
                        1420092379912207260                                  ,
                        1420092379919895060                                  ,
                        1420092379927907160                                  ,
                        1420092379935999840                                  ,
                        1420092379943764380                                  ,
                        1420092379951452420                                  ,
                        1420092379959464220                                  ,
                        1420092379967556420                                  ,
                        1420092379975321140                                  ,
                        1420092379983009180                                  ,
                        1420092379991020560                                  ,
                        1420092379999113060                                  ,
                        1420092380006877840                                  ,
                        1420092380014565340                                  ,
                        1420092380022577140                                  ,
                        1420092380030670420                                  ,
                        1420092380038435320                                  ,
                        1420092380046122400                                  ,
                        1420092380054134200                                  ,
                        1420092380062226820                                  ,
                        1420092380069991780                                  ,
                        1420092380077679280                                  ,
                        1420092380085690840                                  ,
                        1420092380093783580                                  ,
                        1420092380101548960                                  ,
                        1420092380109236280                                  ,
                        1420092380117247300                                  ,
                        1420092380125340520                                  ,
                        1420092380133106080                                  ,
                        1420092380140793520                                  ,
                        1420092380148804120                                  ,
                        1420092380156897220                                  ,
                        1420092380164662420                                  ,
                        1420092380172350040                                  ,
                        1420092380180361240                                  ,
                        1420092380188454460                                  ,
                        1420092380196219720                                  ,
                        1420092380203907280                                  ,
                        1420092380211918420                                  ,
                        1420092380220010920                                  ,
                        1420092380227776660                                  ,
                        1420092380235464400                                  ,
                        1420092380243475180                                  ,
                        1420092380251567740                                  ,
                        1420092380259333540                                  ,
                        1420092380267020680                                  ,
                        1420092380275031820                                  ,
                        1420092380283125160                                  ,
                        1420092380290890780                                  ,
                        1420092380298578160                                  ,
                        1420092380306589360                                  ,
                        1420092380314682160                                  ,
                        1420092380322447480                                  ,
                        1420092380330135160                                  ,
                        1420092380338146180                                  ,
                        1420092380346239100                                  ,
                        1420092380354004540                                  ,
                        1420092380361692100                                  ,
                        1420092380369702820                                  ,
                        1420092380377796400                                  ,
                        1420092380385562200                                  ,
                        1420092380393249280                                  ,
                        1420092380401259940                                  ,
                        1420092380409353280                                  ,
                        1420092380417118960                                  ,
                        1420092380424805860                                  ,
                        1420092380432816940                                  ,
                        1420092380440910400                                  ,
                        1420092380448676320                                  ,
                        1420092380456363280                                  ,
                        1420092380464373940                                  ,
                        1420092380472466980                                  ,
                        1420092380480233320                                  ,
                        1420092380487920640                                  ,
                        1420092380495930580                                  ,
                        1420092380504023620                                  ,
                        1420092380511789840                                  ,
                        1420092380519477040                                  ,
                        1420092380527487220                                  ,
                        1420092380535580980                                  ,
                        1420092380543347080                                  ,
                        1420092380551034220                                  ,
                        1420092380559044640                                  ,
                        1420092380567137620                                  ,
                        1420092380574903600                                  ,
                        1420092380582591160                                  ,
                        1420092380590601580                                  ,
                        1420092380598694260                                  ,
                        1420092380606460540                                  ,
                        1420092380614147620                                  ,
                        1420092380622157800                                  ,
                        1420092380630251140                                  ,
                        1420092380638017720                                  ,
                        1420092380645704740                                  ,
                        1420092380653714920                                  ,
                        1420092380661808080                                  ,
                        1420092380669574120                                  ,
                        1420092380677261200                                  ,
                        1420092380685271620                                  ,
                        1420092380693365080                                  ,
                        1420092380701131000                                  ,
                        1420092380708818020                                  ,
                        1420092380716828260                                  ,
                        1420092380724921660                                  ,
                        1420092380732687940                                  ,
                        1420092380740375140                                  ,
                        1420092380748384960                                  ,
                        1420092380756478420                                  ,
                        1420092380764244700                                  ,
                        1420092380771931300                                  ,
                        1420092380779941360                                  ,
                        1420092380788035600                                  ,
                        1420092380795802240                                  ,
                        1420092380803488660                                  ,
                        1420092380811498900                                  ,
                        1420092380819592540                                  ,
                        1420092380827359240                                  ,
                        1420092380835045840                                  ,
                        1420092380843055600                                  ,
                        1420092380851149060                                  ,
                        1420092380858916060                                  ,
                        1420092380866602900                                  ,
                        1420092380874612120                                  ,
                        1420092380882706300                                  ,
                        1420092380890473540                                  ,
                        1420092380898160560                                  ,
                        1420092380906169660                                  ,
                        1420092380914263540                                  ,
                        1420092380922030300                                  ,
                        1420092380929717140                                  ,
                        1420092380937726720                                  ,
                        1420092380945820360                                  ,
                        1420092380953587240                                  ,
                        1420092380961274320                                  ,
                        1420092380969283960                                  ,
                        1420092380977377240                                  ,
                        1420092380985144600                                  ,
                        1420092380992831740                                  ,
                        1420092381000841140                                  ,
                        1420092381008934240                                  ,
                        1420092381016701360                                  ,
                        1420092381024388080                                  ,
                        1420092381032397660                                  ,
                        1420092381040491600                                  ,
                        1420092381048258480                                  ,
                        1420092381055945020                                  ,
                        1420092381063954900                                  ,
                        1420092381072048480                                  ,
                        1420092381079815120                                  ,
                        1420092381087502200                                  ,
                        1420092381095511780                                  ,
                        1420092381103605300                                  ,
                        1420092381111372000                                  ,
                        1420092381119058660                                  ,
                        1420092381127067880                                  ,
                        1420092381135162300                                  ,
                        1420092381142929540                                  ,
                        1420092381150615780                                  ,
                        1420092381158625060                                  ,
                        1420092381166719300                                  ,
                        1420092381174486360                                  ,
                        1420092381182172180                                  ,
                        1420092381190181580                                  ,
                        1420092381198275700                                  ,
                        1420092381206043060                                  ,
                        1420092381213729240                                  ,
                        1420092381221738160                                  ,
                        1420092381229832280                                  ,
                        1420092381237600120                                  ,
                        1420092381245286720                                  ,
                        1420092381253295040                                  ,
                        1420092381261389040                                  ,
                        1420092381269156760                                  ,
                        1420092381276842880                                  ,
                        1420092381284851260                                  ,
                        1420092381292945800                                  ,
                        1420092381300713460                                  ,
                        1420092381308399880                                  ,
                        1420092381316408740                                  ,
                        1420092381324502680                                  ,
                        1420092381332270400                                  ,
                        1420092381339957180                                  ,
                        1420092381347965980                                  ,
                        1420092381356059380                                  ,
                        1420092381363827340                                  ,
                        1420092381371513760                                  ,
                        1420092381379522260                                  ,
                        1420092381387616380                                  ,
                        1420092381395384640                                  ,
                        1420092381403070820                                  ,
                        1420092381411079500                                  ,
                        1420092381419173620                                  ,
                        1420092381426941220                                  ,
                        1420092381434627760                                  ,
                        1420092381442636620                                  ,
                        1420092381450730680                                  ,
                        1420092381458498160                                  ,
                        1420092381466184820                                  ,
                        1420092381474193380                                  ,
                        1420092381482287620                                  ,
                        1420092381490055580                                  ,
                        1420092381497742180                                  ,
                        1420092381505750620                                  ,
                        1420092381513844860                                  ,
                        1420092381521612700                                  ,
                        1420092381529298400                                  ,
                        1420092381537307020                                  ,
                        1420092381545401740                                  ,
                        1420092381553169820                                  ,
                        1420092381560855580                                  ,
                        1420092381568864440                                  ,
                        1420092381576958860                                  ,
                        1420092381584727060                                  ,
                        1420092381592413300                                  ,
                        1420092381600421680                                  ,
                        1420092381608515800                                  ,
                        1420092381616284060                                  ,
                        1420092381623970000                                  ,
                        1420092381631977600                                  ,
                        1420092381640072500                                  ,
                        1420092381647841060                                  ,
                        1420092381655527240                                  ,
                        1420092381663535080                                  ,
                        1420092381671629800                                  ,
                        1420092381679398000                                  ,
                        1420092381687084180                                  ,
                        1420092381695092260                                  ,
                        1420092381703186500                                  ,
                        1420092381710954760                                  ,
                        1420092381718640940                                  ,
                        1420092381726648840                                  ,
                        1420092381734743020                                  ,
                        1420092381742511880                                  ,
                        1420092381750197880                                  ,
                        1420092381758205660                                  ,
                        1420092381766299720                                  ,
                        1420092381774068340                                  ,
                        1420092381781754220                                  ,
                        1420092381789762060                                  ,
                        1420092381797856600                                  ,
                        1420092381805625040                                  ,
                        1420092381813311040                                  ,
                        1420092381821319120                                  ,
                        1420092381829413600                                  ,
                        1420092381837181860                                  ]
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
class Earth               (                                                ) :
  ############################################################################
  def __init__            ( self                                           ) :
    ##########################################################################
    ##########################################################################
    return
  ############################################################################
  def __del__             ( self                                           ) :
    ##########################################################################
    ##########################################################################
    return
  ############################################################################
  def LocateSunEarthPerihelion   ( self , SDTime                           ) :
    ##########################################################################
    global SunEarthPerihelions
    ##########################################################################
    AT     = 0
    NEXT   = 1
    CNT    = len                 ( SunEarthPerihelions                       )
    ##########################################################################
    if                           ( SDTime < SunEarthPerihelions [ 0 ]      ) :
      return -1
    ##########################################################################
    while                        ( NEXT < CNT                              ) :
      ########################################################################
      V    = SunEarthPerihelions [ AT                                        ]
      N    = SunEarthPerihelions [ NEXT                                      ]
      ########################################################################
      if                         ( ( SDTime >= V ) and ( SDTime < N )      ) :
        return AT
      ########################################################################
      AT   = AT   + 1
      NEXT = NEXT + 1
    ##########################################################################
    return -1
  ############################################################################
  def TakeSunEarthPerihelion        ( self , AT                            ) :
    ##########################################################################
    global SunEarthPerihelions
    global EarthPerihelionDistances
    ##########################################################################
    if                              ( AT < 0                               ) :
      return                        ( 0 , 0 , 0 , 0 ,                        )
    ##########################################################################
    NEXT = AT + 1
    ##########################################################################
    V    = SunEarthPerihelions      [ AT                                     ]
    N    = SunEarthPerihelions      [ NEXT                                   ]
    ##########################################################################
    VD   = EarthPerihelionDistances [ AT                                     ]
    ND   = EarthPerihelionDistances [ NEXT                                   ]
    ##########################################################################
    return                          ( V , N , VD , ND ,                      )
  ############################################################################
  def TakeSunEarthAphelion          ( self , AT                            ) :
    ##########################################################################
    global SunEarthAphelions
    global EarthAphelionDistances
    ##########################################################################
    if                              ( AT < 0                               ) :
      return                        ( 0 , 0 , 0 , 0 ,                        )
    ##########################################################################
    NEXT = AT + 1
    ##########################################################################
    V    = SunEarthAphelions        [ AT                                     ]
    N    = SunEarthAphelions        [ NEXT                                   ]
    ##########################################################################
    VD   = EarthAphelionDistances   [ AT                                     ]
    ND   = EarthAphelionDistances   [ NEXT                                   ]
    ##########################################################################
    return                          ( V , N , VD , ND ,                      )
  ############################################################################
  ############################################################################
  def LocateEquinoxAngles  ( self , SDTime                                 ) :
    ##########################################################################
    global EquinoxAngles
    ##########################################################################
    AT     = 0
    NEXT   = 1
    CNT    = len           ( EquinoxAngles                                   )
    ##########################################################################
    if                     ( SDTime < EquinoxAngles [ 0 ]                  ) :
      return -1
    ##########################################################################
    while                  ( NEXT < CNT                                    ) :
      ########################################################################
      V    = EquinoxAngles [ AT                                              ]
      N    = EquinoxAngles [ NEXT                                            ]
      ########################################################################
      if                   ( ( SDTime >= V ) and ( SDTime < N )            ) :
        return AT
      ########################################################################
      AT   = AT   + 1
      NEXT = NEXT + 1
    ##########################################################################
    return -1
  ############################################################################
  def TakeEquinoxAngles  ( self , AT                                       ) :
    ##########################################################################
    global EquinoxAngles
    ##########################################################################
    return EquinoxAngles [ AT                                                ]
  ############################################################################
  def AdjustTzDiff ( self , SECONDs , TzDIFF                               ) :
    return int     ( int ( int ( SECONDs ) + 86400 + TzDIFF ) % 86400        )
  ############################################################################
  ## JC : Julian Century
  ## MA : MeanAnomaly
  ############################################################################
  def AdjustCenterOfSun     ( self , JC , MA                               ) :
    ##########################################################################
    global SUNcsin1mb
    global SUNcsin1mc
    global SUNcsin1md
    global SUNcsin2mb
    global SUNcsin2mc
    global SUNcsin3m
    ##########################################################################
    R1    = gmpy2 . radians ( MA                                             )
    R2    = R1 + R1
    R3    = R2 + R1
    ##########################################################################
    sin1m = gmpy2 . sin     ( R1                                             )
    sin2m = gmpy2 . sin     ( R2                                             )
    sin3m = gmpy2 . sin     ( R3                                             )
    ##########################################################################
    return ( sin1m * ( SUNcsin1mb - ( SUNcsin1mc + ( SUNcsin1md * JC ) ) * JC ) ) + \
           ( sin2m * ( SUNcsin2mb - ( SUNcsin2mc * JC ) )                ) + \
           ( sin3m *   SUNcsin3m                                             )
  ############################################################################
  def SubtractAngle ( self , A , B                                         ) :
    ##########################################################################
    global ThreeCircle
    ##########################################################################
    return          ( ThreeCircle + A - B ) % 360.0
  ############################################################################
  def AdjustToHorizon     ( self , Altitude , Radius = 6371000.0           ) :
    ##########################################################################
    if                    ( Altitude <= 0                                  ) :
      return 0.0
    ##########################################################################
    return math . degrees ( math . acos ( Radius / ( Radius + Altitude ) )   )
  ############################################################################
  def RefractionAtZenith ( self , Zenith                                   ) :
    ##########################################################################
    elevation               = 90 - Zenith
    if                   ( elevation >= 85.0                               ) :
      return 0
    ##########################################################################
    refraction_correction   = 0.0
    te                      = math . tan ( math . radians ( elevation )      )
    ##########################################################################
    if                   ( elevation > 5.0                                 ) :
      ########################################################################
      t2                    = te * te
      t3                    = te * t2
      t5                    = t2 * t3
      refraction_correction = ( 58.1     / te                            ) - \
                              ( 0.07     / t3                            ) + \
                              ( 0.000086 / t5                                )
      ########################################################################
    elif                 ( elevation > -0.575                              ) :
      ########################################################################
      step1                 = -12.79 + elevation * 0.711
      step2                 =  103.4 + elevation * step1
      step3                 = -518.2 + elevation * step2
      refraction_correction = 1735.0 + elevation * step3
      ########################################################################
    else                                                                     :
      ########################################################################
      refraction_correction = float   ( -20.774               / te           )
    ##########################################################################
    return float                      ( refraction_correction / 3600.0       )
  ############################################################################
  ############################################################################
  ############################################################################
  ############################################################################
  ############################################################################
  ############################################################################
  ############################################################################
  ############################################################################
  ############################################################################
  ## JC : Julian Century
  ############################################################################
  def eccentricityJC   ( self , JC                                         ) :
    ##########################################################################
    global Eccentricity
    global Eb
    global Ec
    ##########################################################################
    return Eccentricity - ( JC * ( Eb + ( JC * Ec ) ) )
  ############################################################################
  ## T : J2000 seconds
  ############################################################################
  def eccentricity               ( self , T                                ) :
    return self . eccentricityJC ( JulianDayToJulianCentury ( T )            )
  ############################################################################
  ## JC : Julian Century
  ############################################################################
  def SunMeanAnomalyJC ( self , JC                                         ) :
    ##########################################################################
    global SUNmeanAnomaly
    global SUNmab
    global SUNmac
    ##########################################################################
    return ( SUNmeanAnomaly + ( JC * ( SUNmab - ( JC * SUNmac ) ) ) ) % 360.0
  ############################################################################
  ## T : J2000 seconds
  ############################################################################
  def SunMeanAnomaly               ( self , T                              ) :
    return self . SunMeanAnomalyJC ( JulianDayToJulianCentury ( T )          )
  ############################################################################
  ## JC : Julian Century
  ############################################################################
  def SunTrueAnomalyJC            ( self , JC                              ) :
    ##########################################################################
    MA = self . SunMeanAnomalyJC  ( JC                                       )
    SC = self . AdjustCenterOfSun ( JC , MA                                  )
    ##########################################################################
    return ( MA + SC ) % 360.0
  ############################################################################
  ## T : J2000 seconds
  ############################################################################
  def SunTrueAnomaly               ( self , T                              ) :
    return self . SunTrueAnomalyJC ( JulianDayToJulianCentury ( T )          )
  ############################################################################
  ## JC : Julian Century
  ############################################################################
  def SunMeanLongitudeJC ( self , JC                                       ) :
    ##########################################################################
    global SUNmeanLongitude
    global SUNmlb
    global SUNmlc
    ##########################################################################
    return ( SUNmeanLongitude + ( JC * ( SUNmlb + ( JC * SUNmlc ) ) ) ) % 360.0
  ############################################################################
  ## T : J2000 seconds
  ############################################################################
  def SunMeanLongitude               ( self , T                            ) :
    return self . SunMeanLongitudeJC ( JulianDayToJulianCentury ( T )        )
  ############################################################################
  ## JC : Julian Century
  ############################################################################
  def SunTrueLongitudeJC           ( self , JC                             ) :
    ##########################################################################
    ML = self . SunMeanLongitudeJC ( JC                                      )
    MA = self . SunMeanAnomalyJC   ( JC                                      )
    SC = self . AdjustCenterOfSun  ( JC , MA                                 )
    ##########################################################################
    return ( ML + SC ) % 360.0
  ############################################################################
  ## T : J2000 seconds
  ############################################################################
  def SunTrueLongitude               ( self , T                            ) :
    return self . SunTrueLongitudeJC ( JulianDayToJulianCentury ( T )        )
  ############################################################################
  ## JC : Julian Century
  ############################################################################
  def SunRadialVectorJC           ( self , JC                              ) :
    ##########################################################################
    global SUNradVector
    ##########################################################################
    ONE = mpfr                    ( "1" , 1024                               )
    V   = self . SunTrueAnomalyJC ( JC                                       )
    E   = self . eccentricityJC   ( JC                                       )
    ##########################################################################
    return ( SUNradVector * ( ONE - ( E * E ) )                          ) / \
           ( ONE          + ( E * gmpy2 . cos ( gmpy2 . radians ( V ) ) )    )
  ############################################################################
  ## T : J2000 seconds
  ############################################################################
  def SunRadialVector               ( self , T                             ) :
    return self . SunRadialVectorJC ( JulianDayToJulianCentury ( T )         )
  ############################################################################
  def SunOmegaAngleJC  ( self , JC                                         ) :
    ##########################################################################
    global SUNomegab
    global SUNomegac
    ##########################################################################
    return ( SUNomegab - ( SUNomegac * JC ) ) % 360.0
  ############################################################################
  ## T : J2000 seconds
  ############################################################################
  def SunOmegaAngle               ( self , T                               ) :
    return self . SunOmegaAngleJC ( JulianDayToJulianCentury ( T )           )
  ############################################################################
  def SunApparentLongitudeJC        ( self , JC                            ) :
    ##########################################################################
    global SUNapparentLa
    global SUNapparentLb
    ##########################################################################
    TL = self  . SunTrueLongitudeJC ( JC                                     )
    OA = self  . SunOmegaAngleJC    ( JC                                     )
    TL = TL    - SUNapparentLa
    SR = gmpy2 . sin                ( gmpy2 . radians ( OA )                 )
    ##########################################################################
    return ( TL - ( SUNapparentLb * SR ) ) % 360.0
  ############################################################################
  ## T : J2000 seconds
  ############################################################################
  def SunApparentLongitude               ( self , T                        ) :
    return self . SunApparentLongitudeJC ( JulianDayToJulianCentury ( T )    )
  ############################################################################
  def SunMeanObliquityEclipticJC ( self , JC                               ) :
    ##########################################################################
    global Sminute
    global SUNmoeA
    global SUNmoeB
    global SUNmoeC
    global SUNmoeD
    global SUNmoeE
    global SUNmoeF
    ##########################################################################
    SA = SUNmoeB + ( JC * ( SUNmoeC - ( JC * SUNmoeD ) ) )
    SS = SUNmoeA - ( JC * SA )
    ##########################################################################
    return ( SUNmoeE + ( ( SUNmoeF + ( SS / Sminute ) ) / Sminute ) )
  ############################################################################
  ## T : J2000 seconds
  ############################################################################
  def SunMeanObliquityEcliptic               ( self , T                    ) :
    return self . SunMeanObliquityEclipticJC ( JulianDayToJulianCentury (T)  )
  ############################################################################
  def SunObliquityCorrectionJC ( self , JC                                 ) :
    ##########################################################################
    global SUNobc
    ##########################################################################
    E0 = self . SunMeanObliquityEclipticJC ( JC                              )
    OA = self . SunOmegaAngleJC            ( JC                              )
    CR = gmpy2 . cos                       ( gmpy2 . radians ( OA )          )
    ##########################################################################
    return                                 ( E0 + ( SUNobc * CR )            )
  ############################################################################
  ## T : J2000 seconds
  ############################################################################
  def SunObliquityCorrection               ( self , T                      ) :
    return self . SunObliquityCorrectionJC ( JulianDayToJulianCentury ( T )  )
  ############################################################################
  def SunRightAscensionJC                   ( self , JC                    ) :
    ##########################################################################
    global ThreeCircle
    ##########################################################################
    OC  = self  . SunObliquityCorrectionJC  ( JC                             )
    AL  = self  . SunApparentLongitudeJC    ( JC                             )
    ##########################################################################
    OCR = gmpy2 . radians                   ( OC                             )
    ALR = gmpy2 . radians                   ( AL                             )
    ##########################################################################
    Y   = gmpy2 . cos ( OCR ) * gmpy2 . sin ( ALR                            )
    X   =                       gmpy2 . cos ( ALR                            )
    ##########################################################################
    D   = gmpy2 . degrees                   ( gmpy2 . atan2 ( Y , X )        )
    ##########################################################################
    return ( ThreeCircle + D ) % 360.0
  ############################################################################
  ## T : J2000 seconds
  ############################################################################
  def SunRightAscension               ( self , T                           ) :
    return self . SunRightAscensionJC ( JulianDayToJulianCentury ( T )       )
  ############################################################################
  def SunDeclinationJC                      ( self , JC                    ) :
    ##########################################################################
    global ThreeCircle
    ##########################################################################
    OC  = self  . SunObliquityCorrectionJC  ( JC                             )
    AL  = self  . SunApparentLongitudeJC    ( JC                             )
    ##########################################################################
    OCR = gmpy2 . radians                   ( OC                             )
    ALR = gmpy2 . radians                   ( AL                             )
    ##########################################################################
    SNT = gmpy2 . sin ( OCR ) * gmpy2 . sin ( ALR                            )
    D   = gmpy2 . degrees                   ( gmpy2 . asin ( SNT )           )
    ##########################################################################
    return ( ThreeCircle + D ) % 360.0
  ############################################################################
  ## T : J2000 seconds
  ############################################################################
  def SunDeclination               ( self , T                              ) :
    return self . SunDeclinationJC ( JulianDayToJulianCentury ( T )          )
  ############################################################################
  def SunTanObliquity2JC                    ( self , JC                    ) :
    ##########################################################################
    OC  = self  . SunObliquityCorrectionJC  ( JC                             )
    OCR = gmpy2 . radians                   ( OC                             )
    ##########################################################################
    Y   = gmpy2 . tan                       ( OCR / 2.0                      )
    ##########################################################################
    return Y * Y
  ############################################################################
  ## T : J2000 seconds
  ############################################################################
  def SunTanObliquity2               ( self , T                            ) :
    return self . SunTanObliquity2JC ( JulianDayToJulianCentury ( T )        )
  ############################################################################
  def SunEqualOfTimeJC                  ( self , JC                        ) :
    ##########################################################################
    L0     = self  . SunMeanLongitudeJC ( JC                                 )
    E      = self  . eccentricityJC     ( JC                                 )
    MA     = self  . SunMeanAnomalyJC   ( JC                                 )
    Y      = self  . SunTanObliquity2JC ( JC                                 )
    ##########################################################################
    RMA    = gmpy2 . radians            ( MA                                 )
    RL0    = gmpy2 . radians            ( L0                                 )
    RL2    = RL0 * 2.0
    RL4    = RL0 * 4.0
    RMA2   = RMA * 2.0
    ##########################################################################
    SIN2L0 = gmpy2 . sin                ( RL2                                )
    COS2L0 = gmpy2 . cos                ( RL2                                )
    SIN4L0 = gmpy2 . sin                ( RL4                                )
    SINMA  = gmpy2 . sin                ( RMA                                )
    SINMA2 = gmpy2 . sin                ( RMA2                               )
    ##########################################################################
    etime  =                            ( Y     * SIN2L0                 ) - \
                                        ( E     * SINMA           * 2.0  ) + \
                                        ( E * Y * SINMA  * COS2L0 * 4.0  ) - \
                                        ( Y * Y * SIN4L0          * 0.5  ) - \
                                        ( E * E * SINMA2          * 1.25     )
    ##########################################################################
    return gmpy2 . degrees ( etime ) * 4.0
  ############################################################################
  ## T : J2000 seconds
  ############################################################################
  def SunEqualOfTime               ( self , T                              ) :
    return self . SunEqualOfTimeJC ( JulianDayToJulianCentury ( T )          )
  ############################################################################
  def SunHourAngle           ( self                                        , \
                               Latitude                                    , \
                               Declination                                 , \
                               Zenith                                      , \
                               isRising                                    ) :
    ##########################################################################
    RLAT  = gmpy2 . radians  ( Latitude                                      )
    RDEC  = gmpy2 . radians  ( Declination                                   )
    RZEN  = gmpy2 . radians  ( Zenith                                        )
    ##########################################################################
    A     = gmpy2 . sin ( RLAT ) * gmpy2 . sin ( RDEC )
    B     = gmpy2 . cos ( RLAT ) * gmpy2 . cos ( RDEC )
    C     = gmpy2 . cos ( RZEN ) - A
    ##########################################################################
    HourAngle = gmpy2 . acos ( C / B                                         )
    ##########################################################################
    if                       ( not isRising                                ) :
      HourAngle = - HourAngle
    ##########################################################################
    return HourAngle
  ############################################################################
  def SunTimeOfTransitJC               ( self                              , \
                                         JC                                , \
                                         Latitude                          , \
                                         Longitude                         , \
                                         Altitude                          , \
                                         Zenith                            , \
                                         isRising                          , \
                                         withRefraction = True             ) :
    ##########################################################################
    if                                 ( Latitude >  89.8                  ) :
      Latitude   = 89.8
    elif                               ( Latitude < -89.8                  ) :
      Latitude   = -89.8
    ##########################################################################
    elevation    = 0.0
    ##########################################################################
    if                                 ( Altitude > 0.001                  ) :
      elevation  = self . AdjustToHorizon ( Altitude                         )
    ##########################################################################
    refraction   = 0.0
    ##########################################################################
    if                                 ( withRefraction                    ) :
      ########################################################################
      refraction = self . RefractionAtZenith ( Zenith + elevation            )
    ##########################################################################
    adjustment   = mpfr                ( 0.0 , 1024                          )
    timeUTC      = 0.0
    ##########################################################################
    for _ in range                     ( 3                                 ) :
      ########################################################################
      JX         = JC + adjustment
      DEC        = self . SunDeclinationJC ( JX                              )
      ZAA        = Zenith + elevation + refraction
      HourAngle  = self . SunHourAngle ( Latitude                            ,
                                         DEC                                 ,
                                         ZAA                                 ,
                                         isRising                            )
      ########################################################################
      delta      = - Longitude - float ( gmpy2 . degrees ( HourAngle )       )
      EQTIME     = self . SunEqualOfTimeJC ( JX                              )
      offset     = float               ( delta * 4.0 - float ( EQTIME )      )
      ########################################################################
      if                               ( offset < -720.0                   ) :
        offset  += 1440.0
      ########################################################################
      timeUTC    = ( 720.0 + offset ) * 60.0
      adjustment = JulianDayToJulianCentury ( timeUTC                        )
    ##########################################################################
    return timeUTC
  ############################################################################
  def SunTimeOfTransit               ( self                                , \
                                       T                                   , \
                                       Latitude                            , \
                                       Longitude                           , \
                                       Altitude                            , \
                                       Zenith                              , \
                                       isRising                            , \
                                       withRefraction                      ) :
    return self . SunTimeOfTransitJC ( JulianDayToJulianCentury ( T )      , \
                                       Latitude                            , \
                                       Longitude                           , \
                                       Altitude                            , \
                                       Zenith                              , \
                                       isRising                            , \
                                       withRefraction                        )
  ############################################################################
  def SunTimeAtElevationJC           ( self                                , \
                                       JC                                  , \
                                       Latitude                            , \
                                       Longitude                           , \
                                       Altitude                            , \
                                       Elevation                           , \
                                       isRising                            , \
                                       withRefraction = True               ) :
    ##########################################################################
    if                               ( Elevation > 90.0                    ) :
      ########################################################################
      Elevation = float              ( 180.0 - Elevation                     )
      isRising  = False
    ##########################################################################
    Zenith = self . SunZenithToElevation ( Elevation                         )
    ##########################################################################
    return self . SunTimeOfTransitJC ( JC                                    ,
                                       Latitude                              ,
                                       Longitude                             ,
                                       Altitude                              ,
                                       Zenith                                ,
                                       isRising                              ,
                                       withRefraction                        )
  ############################################################################
  def SunTimeAtElevation               ( self                              , \
                                         T                                 , \
                                         Latitude                          , \
                                         Longitude                         , \
                                         Altitude                          , \
                                         Elevation                         , \
                                         isRising                          , \
                                         withRefraction                    ) :
    return self . SunTimeAtElevationJC ( JulianDayToJulianCentury ( T )    , \
                                         Latitude                          , \
                                         Longitude                         , \
                                         Altitude                          , \
                                         Elevation                         , \
                                         isRising                          , \
                                         withRefraction                      )
  ############################################################################
  def SunZenithAzimuthJC                ( self                             , \
                                          JC                               , \
                                          SecondsOfDay                     , \
                                          UtcTzDiff                        , \
                                          Latitude                         , \
                                          Longitude                        , \
                                          withRefraction = True            ) :
    ##########################################################################
    if                                  ( Latitude >  89.8                 ) :
      Latitude      = 89.8
    elif                                ( Latitude < -89.8                 ) :
      Latitude      = -89.8
    ##########################################################################
    TzZone          = -                 ( float ( UtcTzDiff    ) / 60.0      )
    SOD             =                   ( float ( SecondsOfDay ) / 60.0      )
    DEC             = self . SunDeclinationJC ( JC                           )
    EQTIME          = self . SunEqualOfTimeJC ( JC                           )
    ##########################################################################
    ## 360deg * 4 == 1440 minutes, 60*24 = 1440 minutes == 1 rotation
    ##########################################################################
    solarTimeFix    = float ( EQTIME ) + ( 4.0 * Longitude ) + TzZone
    trueSolarTime   = SOD + solarTimeFix
    ##########################################################################
    while                               ( trueSolarTime > 1440.0           ) :
      trueSolarTime = trueSolarTime - 1440.0
    ##########################################################################
    HourAngle       = float             ( trueSolarTime / 4.0 ) - 180.0
    if                                  ( HourAngle < -180.0               ) :
      HourAngle     = HourAngle + 360.0
    ##########################################################################
    RHRA            = math . radians    ( HourAngle                          )
    RLAT            = math . radians    ( Latitude                           )
    RDEC            = math . radians    ( DEC                                )
    ##########################################################################
    CHRA            = math . cos        ( RHRA                               )
    CLAT            = math . cos        ( RLAT                               )
    SLAT            = math . sin        ( RLAT                               )
    CDEC            = math . cos        ( RDEC                               )
    SDEC            = math . sin        ( RDEC                               )
    ##########################################################################
    CSZ             = float ( CLAT * CDEC * CHRA ) + float ( SLAT * SDEC     )
    ##########################################################################
    if                                  ( CSZ > 1.0                        ) :
      CSZ           =  1.0
    elif                                ( CSZ < -1.0                       ) :
      CSZ           = -1.0
    ##########################################################################
    ZRAD            = math . acos       ( CSZ                                )
    Zenith          = math . degrees    ( ZRAD                               )
    azDenom         = CLAT * math . sin ( ZRAD                               )
    ##########################################################################
    if                                  ( math . fabs (azDenom) > 0.000001 ) :
      ########################################################################
      azRad         = float             ( SLAT  * math . cos ( ZRAD )        )
      azRad         = float             ( azRad - SDEC                       )
      azRad         = float             ( azRad / azDenom                    )
      ########################################################################
      if                                ( math . fabs ( azRad ) > 1.0      ) :
        ######################################################################
        if                              ( azRad < 0                        ) :
          azRad     = -1.0
        else                                                                 :
          azRad     =  1.0
      ########################################################################
      azDegree      = math . degrees    ( math . acos ( azRad )              )
      Azimuth       = float             ( 180.0 - azDegree                   )
      ########################################################################
      if                                ( HourAngle > 0.0                  ) :
        Azimuth     = - Azimuth
      ########################################################################
    else                                                                     :
      ########################################################################
      if                                ( Latitude > 0.0                   ) :
        Azimuth     = 180.0
      else                                                                   :
        Azimuth     = 0.0
    ##########################################################################
    if                                  ( Azimuth < 0.0                    ) :
      Azimuth       = Azimuth + 360.0
    ##########################################################################
    if                                  ( withRefraction                   ) :
      Zenith       -= self . RefractionAtZenith ( Zenith                     )
    ##########################################################################
    return Zenith , Azimuth , HourAngle
  ############################################################################
  def SunZenithAzimuth               ( self                                , \
                                       T                                   , \
                                       SecondsOfDay                        , \
                                       UtcTzDiff                           , \
                                       Latitude                            , \
                                       Longitude                           , \
                                       withRefraction                      ) :
    return self . SunZenithAzimuthJC ( JulianDayToJulianCentury ( T )      , \
                                       SecondsOfDay                        , \
                                       UtcTzDiff                           , \
                                       Latitude                            , \
                                       Longitude                           , \
                                       withRefraction                        )
  ############################################################################
  def SunZenithToElevation ( self , Zenith                                 ) :
    return float           ( 90.0 - Zenith                                   )
  ############################################################################
  ############################################################################
  ############################################################################
  ############################################################################
  ############################################################################
  def NoonJC                         ( self , Longitude , JC               ) :
    ##########################################################################
    global TwoCircle
    ##########################################################################
    EQTIME = self . SunEqualOfTimeJC ( JC                                    )
    MLONG  = float                   ( Longitude * 4.0                       )
    NOONSS = float                   ( ( TwoCircle - MLONG - EQTIME ) * 60.0 )
    ##########################################################################
    return int                       ( NOONSS                                )
  ############################################################################
  def Noon               ( self , Longitude , T                            ) :
    return self . NoonJC ( Longitude , JulianDayToJulianCentury ( T )        )
  ############################################################################
  def MidnightJC                     ( self , Longitude , JC               ) :
    ##########################################################################
    global TwoCircle
    ##########################################################################
    EQTIME = self . SunEqualOfTimeJC ( JC                                    )
    MLONG  = float                   ( Longitude * 4.0                       )
    MIDNSS = float                   ( ( MLONG + float ( EQTIME ) ) * -60.0  )
    ##########################################################################
    return int                       ( MIDNSS                                )
  ############################################################################
  def Midnight               ( self , Longitude , T                        ) :
    return self . MidnightJC ( Longitude , JulianDayToJulianCentury ( T )    )
  ############################################################################
  ############################################################################
  ############################################################################
  ############################################################################
  ############################################################################
  ############################################################################
  ############################################################################
  ############################################################################
  def Sunlight                     ( self , Spot , Now , TZ                ) :
    ##########################################################################
    JSON      =                    { "Spot"       : {                      } ,
                                     "Current"    : {                      } ,
                                     "Parameters" : {                      } ,
                                     "Timestamps" : {                      } ,
                                     "DateTime"   : {                      } }
    ##########################################################################
    SN        = Sun                (                                         )
    SDT       = StarDate           (                                         )
    SDT       . Stardate = Now
    ##########################################################################
    MND       = SDT . toDateString       ( TZ , "%Y/%m/%d"                   )
    MNT       = SDT . toDateTimeString   ( TZ                                ,
                                           " "                               ,
                                           "%Y/%m/%d"                        ,
                                           "%H:%M:%S"                        )
    JSON [ "Current"    ] [ "Date"                ] = MND
    JSON [ "Current"    ] [ "DateTime"            ] = MNT
    ##########################################################################
    Latitude  = Spot . Latitude
    Longitude = Spot . Longitude
    Altitude  = Spot . Altitude
    ##########################################################################
    KDT       = SDT . Stardate
    SOD       = SDT . SecondsOfDay ( TZ                                      )
    BDT       = int                ( KDT - SOD                               )
    NDT       = int                ( BDT + 43200                             )
    PDT       = int                ( BDT - 86400                             )
    ZDT       = int                ( BDT + 86400                             )
    TzDiff    = SDT . TzDiff       ( "UTC" , TZ                              )
    ##########################################################################
    SDT       . Stardate = KDT
    JC        = JulianDayToJulianCentury ( SDT . toJ2000 ( )                 )
    ##########################################################################
    SDT       . Stardate = BDT
    JB        = JulianDayToJulianCentury ( SDT . toJ2000 ( )                 )
    ##########################################################################
    SDT       . Stardate = NDT
    JN        = JulianDayToJulianCentury ( SDT . toJ2000 ( )                 )
    ##########################################################################
    SDT       . Stardate = PDT
    JP        = JulianDayToJulianCentury ( SDT . toJ2000 ( )                 )
    ##########################################################################
    SDT       . Stardate = ZDT
    JZ        = JulianDayToJulianCentury ( SDT . toJ2000 ( )                 )
    ##########################################################################
    JSON [ "Spot"       ] [ "Latitude"            ] = Latitude
    JSON [ "Spot"       ] [ "Longitude"           ] = Longitude
    JSON [ "Spot"       ] [ "Altitude"            ] = Altitude
    JSON [ "Current"    ] [ "TimeZone"            ] = TZ
    JSON [ "Current"    ] [ "TimeDefault"         ] = KDT
    JSON [ "Current"    ] [ "TimeBase"            ] = BDT
    JSON [ "Current"    ] [ "TimeNoon"            ] = NDT
    JSON [ "Current"    ] [ "Seconds-Of-Day"      ] = SOD
    JSON [ "Current"    ] [ "TimeZone-Difference" ] = TzDiff
    JSON [ "Current"    ] [ "J2000-Current"       ] = float ( JC             )
    JSON [ "Current"    ] [ "J2000-Night"         ] = float ( JB             )
    JSON [ "Current"    ] [ "J2000-Noon"          ] = float ( JN             )
    ##########################################################################
    Zenith , Azimuth , HourAngle = self . SunZenithAzimuthJC                 (
                                     JN                                    , \
                                     43200                                 , \
                                     TzDiff                                , \
                                     Latitude                              , \
                                     Longitude                             , \
                                     True                                    )
    ##########################################################################
    JSON [ "Parameters" ] [ "Zenith"              ] = float ( Zenith         )
    JSON [ "Parameters" ] [ "Azimuth"             ] = float ( Azimuth        )
    JSON [ "Parameters" ] [ "Hour-Angle"          ] = float ( HourAngle      )
    ##########################################################################
    PolarNight   = False
    if                             ( Zenith > 90.0                         ) :
      PolarNight = True
    ##########################################################################
    AT              = self . LocateSunEarthPerihelion ( NDT                  )
    V , N , VD , ND = self . TakeSunEarthPerihelion   ( AT                   )
    ##########################################################################
    JSON [ "Parameters" ] [ "Perihelion"               ] = V
    JSON [ "Parameters" ] [ "Perihelion-Next"          ] = N
    JSON [ "Parameters" ] [ "Perihelion-Distance"      ] = VD
    JSON [ "Parameters" ] [ "Perihelion-Next-Distance" ] = ND
    ##########################################################################
    VAP , NAP , VDAP , NDAP = self . TakeSunEarthAphelion ( AT               )
    JSON [ "Parameters" ] [ "Aphelion"                 ] = VAP
    JSON [ "Parameters" ] [ "Aphelion-Next"            ] = NAP
    JSON [ "Parameters" ] [ "Aphelion-Distance"        ] = VDAP
    JSON [ "Parameters" ] [ "Aphelion-Next-Distance"   ] = NDAP
    ##########################################################################
    MLD = float ( float ( VD + VDAP ) / 2.0 )
    JSON [ "Parameters" ] [ "Earth-Long-Axis"          ] = MLD
    ##########################################################################
    PERX      = mpfr                              ( MLD , 1024               )
    ##########################################################################
    SDT       . Stardate = V
    RC        = JulianDayToJulianCentury          ( SDT . toJ2000 (        ) )
    JPEMA     = self . SunMeanAnomalyJC           ( RC                       )
    ##########################################################################
    JSON [ "Parameters" ] [ "Perihelion-Mean-Anomaly"  ] = float ( JPEMA     )
    ##########################################################################
    MA        = self . SunMeanAnomalyJC           ( JN                       )
    ML        = self . SunMeanLongitudeJC         ( JN                       )
    TA        = self . SunTrueAnomalyJC           ( JN                       )
    TL        = self . SunTrueLongitudeJC         ( JN                       )
    RV        = self . SunRadialVectorJC          ( JN                       )
    OA        = self . SunOmegaAngleJC            ( JN                       )
    AL        = self . SunApparentLongitudeJC     ( JN                       )
    OE        = self . SunMeanObliquityEclipticJC ( JN                       )
    OC        = self . SunObliquityCorrectionJC   ( JN                       )
    RA        = self . SunRightAscensionJC        ( JN                       )
    DEC       = self . SunDeclinationJC           ( JN                       )
    OY2       = self . SunTanObliquity2JC         ( JN                       )
    EE        = self . eccentricityJC             ( JN                       )
    DA        = self . SubtractAngle              ( MA , JPEMA               )
    DIST      = SN   . Distance                   ( EE , PERX , TA           )
    Angular   = SN   . AngularDiameter            ( DIST                     )
    EOT       = self . SunEqualOfTimeJC           ( JN                       )
    ##########################################################################
    FAngular  = float                             ( Angular                  )
    HAngular  = float                             ( FAngular / 2.0           )
    VAngular  = float                             ( 90.0 + HAngular          )
    CAngular  = float                             ( 90.0 + FAngular          )
    ##########################################################################
    EternDay  = float                             ( 90.0 - OC                )
    ##########################################################################
    JSON [ "Parameters" ] [ "Mean-Anomaly"             ] = float ( MA        )
    JSON [ "Parameters" ] [ "Mean-Longitude"           ] = float ( ML        )
    JSON [ "Parameters" ] [ "True-Anomaly"             ] = float ( TA        )
    JSON [ "Parameters" ] [ "True-Longitude"           ] = float ( TL        )
    JSON [ "Parameters" ] [ "Radial-Vector"            ] = float ( RV        )
    JSON [ "Parameters" ] [ "Omega"                    ] = float ( OA        )
    JSON [ "Parameters" ] [ "Apparent-Longitude"       ] = float ( AL        )
    JSON [ "Parameters" ] [ "Mean-Obliquity-Ecliptic"  ] = float ( OE        )
    JSON [ "Parameters" ] [ "Obliquity-Correction"     ] = float ( OC        )
    JSON [ "Parameters" ] [ "Eternal-Day"              ] = float ( EternDay  )
    JSON [ "Parameters" ] [ "Right-Ascension"          ] = float ( RA        )
    JSON [ "Parameters" ] [ "Declination"              ] = float ( DEC       )
    JSON [ "Parameters" ] [ "Eccentricity"             ] = float ( EE        )
    JSON [ "Parameters" ] [ "Distance"                 ] = float ( DIST      )
    JSON [ "Parameters" ] [ "Angular-Diameter"         ] = float ( Angular   )
    JSON [ "Parameters" ] [ "Equal"                    ] = float ( EOT       )
    ##########################################################################
    ## 需要計算極晝的公式
    ## EternDay
    ## TL
    ##########################################################################
    PolarDay     = False
    ##########################################################################
    JSON [ "Parameters" ] [ "Polar-Day"           ] = PolarDay
    JSON [ "Parameters" ] [ "Polar-Night"         ] = PolarNight
    ##########################################################################
    ## 計算太陽日正當中
    ##########################################################################
    NOJ       = self . NoonJC            ( Longitude , JN                    )
    EDT       = self . AdjustTzDiff      ( NOJ , TzDiff                      )
    XDT       = int                      ( BDT + EDT                         )
    ##########################################################################
    SDT       . Stardate = XDT
    TNN       = SDT . toDateTimeString   ( TZ                                ,
                                           " "                               ,
                                           "%Y/%m/%d"                        ,
                                           "%H:%M:%S"                        )
    ##########################################################################
    JSON [ "Timestamps" ] [ "Noon"                     ] = XDT
    JSON [ "DateTime"   ] [ "Noon"                     ] = TNN
    ##########################################################################
    JX        = JulianDayToJulianCentury ( SDT . toJ2000 ( )                 )
    MA        = self . SunMeanAnomalyJC           ( JX                       )
    DA        = self . SubtractAngle              ( MA , JPEMA               )
    DIST      = SN   . Distance                   ( EE , PERX , DA           )
    ##########################################################################
    JSON [ "Parameters" ] [ "Noon-Angle"               ] = float ( DA        )
    JSON [ "Parameters" ] [ "Noon-Distance"            ] = float ( DIST      )
    ##########################################################################
    NOJ       = self . MidnightJC        ( Longitude , JB                    )
    EDT       = self . AdjustTzDiff      ( NOJ , TzDiff                      )
    XDT       = int                      ( BDT + EDT                         )
    if                                   ( NOJ > 43200                     ) :
      XDT     = int                      ( XDT - 86400                       )
    ##########################################################################
    SDT       . Stardate = XDT
    MNT       = SDT . toDateTimeString   ( TZ                                ,
                                           " "                               ,
                                           "%Y/%m/%d"                        ,
                                           "%H:%M:%S"                        )
    ##########################################################################
    JSON [ "Timestamps" ] [ "Midnight"                 ] = XDT
    JSON [ "DateTime"   ] [ "Midnight"                 ] = MNT
    ##########################################################################
    NOJ       = self . MidnightJC        ( Longitude , JP                    )
    EDT       = self . AdjustTzDiff      ( NOJ , TzDiff                      )
    XDT       = int                      ( BDT + EDT                         )
    if                                   ( NOJ > 43200                     ) :
      XDT     = int                      ( XDT - 86400                       )
    ##########################################################################
    SDT       . Stardate = XDT
    MNT       = SDT . toDateTimeString   ( TZ                                ,
                                           " "                               ,
                                           "%Y/%m/%d"                        ,
                                           "%H:%M:%S"                        )
    ##########################################################################
    JSON [ "Timestamps" ] [ "Midnight-Previous"        ] = XDT
    JSON [ "DateTime"   ] [ "Midnight-Previous"        ] = MNT
    ##########################################################################
    NOJ       = self . MidnightJC        ( Longitude , JZ                    )
    EDT       = self . AdjustTzDiff      ( NOJ , TzDiff                      )
    XDT       = int                      ( BDT + EDT                         )
    if                                   ( NOJ > 43200                     ) :
      XDT     = int                      ( XDT - 86400                       )
    ##########################################################################
    SDT       . Stardate = XDT
    MNT       = SDT . toDateTimeString   ( TZ                                ,
                                           " "                               ,
                                           "%Y/%m/%d"                        ,
                                           "%H:%M:%S"                        )
    ##########################################################################
    JSON [ "Timestamps" ] [ "Midnight-Next"            ] = XDT
    JSON [ "DateTime"   ] [ "Midnight-Next"            ] = MNT
    ##########################################################################
    SDT       . Stardate = BDT +         ( 3600 * 5                          )
    JR        = JulianDayToJulianCentury ( SDT . toJ2000 ( )                 )
    ##########################################################################
    NOR       = self . SunTimeOfTransitJC ( JR                               ,
                                            Latitude                         ,
                                            Longitude                        ,
                                            Altitude                         ,
                                            VAngular                         ,
                                            True                             ,
                                            True                             )
    EDT       = self . AdjustTzDiff      ( NOR , TzDiff                      )
    XDT       = int                      ( BDT + EDT                         )
    ##########################################################################
    SDT       . Stardate = XDT
    SRT       = SDT . toDateTimeString   ( TZ                                ,
                                           " "                               ,
                                           "%Y/%m/%d"                        ,
                                           "%H:%M:%S"                        )
    ##########################################################################
    JSON [ "Timestamps" ] [ "Sunrise"                  ] = XDT
    JSON [ "DateTime"   ] [ "Sunrise"                  ] = SRT
    ##########################################################################
    NOR       = self . SunTimeOfTransitJC ( JR                               ,
                                            Latitude                         ,
                                            Longitude                        ,
                                            Altitude                         ,
                                            CAngular                         ,
                                            True                             ,
                                            True                             )
    EDT       = self . AdjustTzDiff      ( NOR , TzDiff                      )
    XDT       = int                      ( BDT + EDT                         )
    ##########################################################################
    SDT       . Stardate = XDT
    SRT       = SDT . toDateTimeString   ( TZ                                ,
                                           " "                               ,
                                           "%Y/%m/%d"                        ,
                                           "%H:%M:%S"                        )
    ##########################################################################
    JSON [ "Timestamps" ] [ "Sunrise-Start"             ] = XDT
    JSON [ "DateTime"   ] [ "Sunrise-Start"             ] = SRT
    ##########################################################################
    NOR       = self . SunTimeOfTransitJC ( JR                               ,
                                            Latitude                         ,
                                            Longitude                        ,
                                            Altitude                         ,
                                            90.0                             ,
                                            True                             ,
                                            True                             )
    EDT       = self . AdjustTzDiff      ( NOR , TzDiff                      )
    XDT       = int                      ( BDT + EDT                         )
    ##########################################################################
    SDT       . Stardate = XDT
    SRT       = SDT . toDateTimeString   ( TZ                                ,
                                           " "                               ,
                                           "%Y/%m/%d"                        ,
                                           "%H:%M:%S"                        )
    ##########################################################################
    JSON [ "Timestamps" ] [ "Sunrise-Finish"            ] = XDT
    JSON [ "DateTime"   ] [ "Sunrise-Finish"            ] = SRT
    ##########################################################################
    NOR       = self . SunTimeOfTransitJC ( JR                               ,
                                            Latitude                         ,
                                            Longitude                        ,
                                            Altitude                         ,
                                            90.0 - 6.0                       ,
                                            True                             ,
                                            True                             )
    EDT       = self . AdjustTzDiff      ( NOR , TzDiff                      )
    XDT       = int                      ( BDT + EDT                         )
    ##########################################################################
    SDT       . Stardate = XDT
    SRT       = SDT . toDateTimeString   ( TZ                                ,
                                           " "                               ,
                                           "%Y/%m/%d"                        ,
                                           "%H:%M:%S"                        )
    ##########################################################################
    JSON [ "Timestamps" ] [ "Dawn-Golden"               ] = XDT
    JSON [ "DateTime"   ] [ "Dawn-Golden"               ] = SRT
    ##########################################################################
    NOR       = self . SunTimeOfTransitJC ( JR                               ,
                                            Latitude                         ,
                                            Longitude                        ,
                                            Altitude                         ,
                                            90.0 + 4.0                       ,
                                            True                             ,
                                            True                             )
    EDT       = self . AdjustTzDiff      ( NOR , TzDiff                      )
    XDT       = int                      ( BDT + EDT                         )
    ##########################################################################
    SDT       . Stardate = XDT
    SRT       = SDT . toDateTimeString   ( TZ                                ,
                                           " "                               ,
                                           "%Y/%m/%d"                        ,
                                           "%H:%M:%S"                        )
    ##########################################################################
    JSON [ "Timestamps" ] [ "Dawn-Blue"                 ] = XDT
    JSON [ "DateTime"   ] [ "Dawn-Blue"                 ] = SRT
    ##########################################################################
    NOR       = self . SunTimeOfTransitJC ( JR                               ,
                                            Latitude                         ,
                                            Longitude                        ,
                                            Altitude                         ,
                                            90.0 + 6.0                       ,
                                            True                             ,
                                            True                             )
    EDT       = self . AdjustTzDiff      ( NOR , TzDiff                      )
    XDT       = int                      ( BDT + EDT                         )
    ##########################################################################
    SDT       . Stardate = XDT
    SRT       = SDT . toDateTimeString   ( TZ                                ,
                                           " "                               ,
                                           "%Y/%m/%d"                        ,
                                           "%H:%M:%S"                        )
    ##########################################################################
    JSON [ "Timestamps" ] [ "Dawn-Civil"                ] = XDT
    JSON [ "DateTime"   ] [ "Dawn-Civil"                ] = SRT
    ##########################################################################
    NOR       = self . SunTimeOfTransitJC ( JR                               ,
                                            Latitude                         ,
                                            Longitude                        ,
                                            Altitude                         ,
                                            90.0 + 12.0                      ,
                                            True                             ,
                                            True                             )
    EDT       = self . AdjustTzDiff      ( NOR , TzDiff                      )
    XDT       = int                      ( BDT + EDT                         )
    ##########################################################################
    SDT       . Stardate = XDT
    SRT       = SDT . toDateTimeString   ( TZ                                ,
                                           " "                               ,
                                           "%Y/%m/%d"                        ,
                                           "%H:%M:%S"                        )
    ##########################################################################
    JSON [ "Timestamps" ] [ "Dawn-Nautical"             ] = XDT
    JSON [ "DateTime"   ] [ "Dawn-Nautical"             ] = SRT
    ##########################################################################
    NOR       = self . SunTimeOfTransitJC ( JR                               ,
                                            Latitude                         ,
                                            Longitude                        ,
                                            Altitude                         ,
                                            90.0 + 18.0                      ,
                                            True                             ,
                                            True                             )
    EDT       = self . AdjustTzDiff      ( NOR , TzDiff                      )
    XDT       = int                      ( BDT + EDT                         )
    ##########################################################################
    SDT       . Stardate = XDT
    SRT       = SDT . toDateTimeString   ( TZ                                ,
                                           " "                               ,
                                           "%Y/%m/%d"                        ,
                                           "%H:%M:%S"                        )
    ##########################################################################
    JSON [ "Timestamps" ] [ "Dawn-Astronomical"         ] = XDT
    JSON [ "DateTime"   ] [ "Dawn-Astronomical"         ] = SRT
    ##########################################################################
    SDT       . Stardate = BDT +         ( 3600 * 17                         )
    JS        = JulianDayToJulianCentury ( SDT . toJ2000 ( )                 )
    ##########################################################################
    NOS       = self . SunTimeOfTransitJC ( JS                               ,
                                            Latitude                         ,
                                            Longitude                        ,
                                            Altitude                         ,
                                            VAngular                         ,
                                            False                            ,
                                            True                             )
    EDT       = self . AdjustTzDiff      ( NOS , TzDiff                      )
    WDT       = int                      ( BDT + EDT                         )
    ##########################################################################
    SDT       . Stardate = WDT
    SET       = SDT . toDateTimeString   ( TZ                                ,
                                           " "                               ,
                                           "%Y/%m/%d"                        ,
                                           "%H:%M:%S"                        )
    ##########################################################################
    JSON [ "Timestamps" ] [ "Sunset"                   ] = WDT
    JSON [ "DateTime"   ] [ "Sunset"                   ] = SET
    ##########################################################################
    NOS       = self . SunTimeOfTransitJC ( JS                               ,
                                            Latitude                         ,
                                            Longitude                        ,
                                            Altitude                         ,
                                            CAngular                         ,
                                            False                            ,
                                            True                             )
    EDT       = self . AdjustTzDiff      ( NOS , TzDiff                      )
    WDT       = int                      ( BDT + EDT                         )
    ##########################################################################
    SDT       . Stardate = WDT
    SET       = SDT . toDateTimeString   ( TZ                                ,
                                           " "                               ,
                                           "%Y/%m/%d"                        ,
                                           "%H:%M:%S"                        )
    ##########################################################################
    JSON [ "Timestamps" ] [ "Sunset-Finish"            ] = WDT
    JSON [ "DateTime"   ] [ "Sunset-Finish"            ] = SET
    ##########################################################################
    NOS       = self . SunTimeOfTransitJC ( JS                               ,
                                            Latitude                         ,
                                            Longitude                        ,
                                            Altitude                         ,
                                            90.0                             ,
                                            False                            ,
                                            True                             )
    EDT       = self . AdjustTzDiff      ( NOS , TzDiff                      )
    WDT       = int                      ( BDT + EDT                         )
    ##########################################################################
    SDT       . Stardate = WDT
    SET       = SDT . toDateTimeString   ( TZ                                ,
                                           " "                               ,
                                           "%Y/%m/%d"                        ,
                                           "%H:%M:%S"                        )
    ##########################################################################
    JSON [ "Timestamps" ] [ "Sunset-Start"             ] = WDT
    JSON [ "DateTime"   ] [ "Sunset-Start"             ] = SET
    ##########################################################################
    NOS       = self . SunTimeOfTransitJC ( JS                               ,
                                            Latitude                         ,
                                            Longitude                        ,
                                            Altitude                         ,
                                            90.0 - 6.0                       ,
                                            False                            ,
                                            True                             )
    EDT       = self . AdjustTzDiff      ( NOS , TzDiff                      )
    WDT       = int                      ( BDT + EDT                         )
    ##########################################################################
    SDT       . Stardate = WDT
    SET       = SDT . toDateTimeString   ( TZ                                ,
                                           " "                               ,
                                           "%Y/%m/%d"                        ,
                                           "%H:%M:%S"                        )
    ##########################################################################
    JSON [ "Timestamps" ] [ "Dusk-Golden"              ] = WDT
    JSON [ "DateTime"   ] [ "Dusk-Golden"              ] = SET
    ##########################################################################
    NOS       = self . SunTimeOfTransitJC ( JS                               ,
                                            Latitude                         ,
                                            Longitude                        ,
                                            Altitude                         ,
                                            90.0 + 4.0                       ,
                                            False                            ,
                                            True                             )
    EDT       = self . AdjustTzDiff      ( NOS , TzDiff                      )
    WDT       = int                      ( BDT + EDT                         )
    ##########################################################################
    SDT       . Stardate = WDT
    SET       = SDT . toDateTimeString   ( TZ                                ,
                                           " "                               ,
                                           "%Y/%m/%d"                        ,
                                           "%H:%M:%S"                        )
    ##########################################################################
    JSON [ "Timestamps" ] [ "Dusk-Blue"                ] = WDT
    JSON [ "DateTime"   ] [ "Dusk-Blue"                ] = SET
    ##########################################################################
    NOS       = self . SunTimeOfTransitJC ( JS                               ,
                                            Latitude                         ,
                                            Longitude                        ,
                                            Altitude                         ,
                                            90.0 + 6.0                       ,
                                            False                            ,
                                            True                             )
    EDT       = self . AdjustTzDiff      ( NOS , TzDiff                      )
    WDT       = int                      ( BDT + EDT                         )
    ##########################################################################
    SDT       . Stardate = WDT
    SET       = SDT . toDateTimeString   ( TZ                                ,
                                           " "                               ,
                                           "%Y/%m/%d"                        ,
                                           "%H:%M:%S"                        )
    ##########################################################################
    JSON [ "Timestamps" ] [ "Dusk-Civil"               ] = WDT
    JSON [ "DateTime"   ] [ "Dusk-Civil"               ] = SET
    ##########################################################################
    NOS       = self . SunTimeOfTransitJC ( JS                               ,
                                            Latitude                         ,
                                            Longitude                        ,
                                            Altitude                         ,
                                            90.0 + 12.0                      ,
                                            False                            ,
                                            True                             )
    EDT       = self . AdjustTzDiff      ( NOS , TzDiff                      )
    WDT       = int                      ( BDT + EDT                         )
    ##########################################################################
    SDT       . Stardate = WDT
    SET       = SDT . toDateTimeString   ( TZ                                ,
                                           " "                               ,
                                           "%Y/%m/%d"                        ,
                                           "%H:%M:%S"                        )
    ##########################################################################
    JSON [ "Timestamps" ] [ "Dusk-Nautical"            ] = WDT
    JSON [ "DateTime"   ] [ "Dusk-Nautical"            ] = SET
    ##########################################################################
    NOS       = self . SunTimeOfTransitJC ( JS                               ,
                                            Latitude                         ,
                                            Longitude                        ,
                                            Altitude                         ,
                                            90.0 + 18.0                      ,
                                            False                            ,
                                            True                             )
    EDT       = self . AdjustTzDiff      ( NOS , TzDiff                      )
    WDT       = int                      ( BDT + EDT                         )
    ##########################################################################
    SDT       . Stardate = WDT
    SET       = SDT . toDateTimeString   ( TZ                                ,
                                           " "                               ,
                                           "%Y/%m/%d"                        ,
                                           "%H:%M:%S"                        )
    ##########################################################################
    JSON [ "Timestamps" ] [ "Dusk-Astronomical"        ] = WDT
    JSON [ "DateTime"   ] [ "Dusk-Astronomical"        ] = SET
    ##########################################################################
    return JSON
  ############################################################################
  def LocateTrueLongitude             ( self                                 ,
                                        Start                                ,
                                        Finish                               ,
                                        TrueLongitude                      ) :
    ##########################################################################
    TLS   =                           { 0 : Start                            ,
                                        1 : 0                                ,
                                        2 : 0                                ,
                                        3 : Finish                           }
    TLL   =                           { 0 : 0.0                              ,
                                        1 : 0.0                              ,
                                        2 : 0.0                              ,
                                        3 : 0.0                              }
    NOW   = StarDate                  (                                      )
    ##########################################################################
    TTE   = float                     ( TrueLongitude                        )
    if                                ( TTE < 180.0                        ) :
      TTE = float                     ( TTE + 360.0                          )
    ##########################################################################
    NOW   . Stardate = Start
    JC    = JulianDayToJulianCentury  ( NOW . toJ2000 ( )                    )
    STL   = self . SunTrueLongitudeJC ( JC                                   )
    ##########################################################################
    if                                ( STL < 180.0                        ) :
      ########################################################################
      STL = float                     ( STL + 360.0                          )
      ########################################################################
      if                              ( TTE < 360.0                        ) :
        ######################################################################
        if                            ( ( STL - 360.0 ) > TTE              ) :
          return 0
        ######################################################################
      else                                                                   :
        ######################################################################
        if                            ( STL > TTE                          ) :
          return 0
      ########################################################################
    else                                                                     :
      ########################################################################
      if                              ( TTE > 360.0                        ) :
        ######################################################################
        if                            ( ( STL + 360.0 ) > TTE              ) :
          ####################################################################
          return 0
        ######################################################################
      elif                            ( STL > 360.0                        ) :
        ######################################################################
        if                            ( ( STL - 360.0 ) > TTE              ) :
          return 0
        ######################################################################
      elif                            ( STL > TTE                          ) :
        ######################################################################
        return 0
    ##########################################################################
    NOW   . Stardate = Finish
    JC    = JulianDayToJulianCentury  ( NOW . toJ2000 ( )                    )
    FTL   = self . SunTrueLongitudeJC ( JC                                   )
    ##########################################################################
    if                                ( FTL < 180.0                        ) :
      ########################################################################
      FTL = float                     ( FTL + 360.0                          )
      ########################################################################
      if                              ( TTE < 360.0                        ) :
        ######################################################################
        if                            ( ( FTL - 360.0 ) < TTE              ) :
          return 0
        ######################################################################
      else                                                                   :
        ######################################################################
        if                            ( FTL < TTE                          ) :
          return 0
      ########################################################################
    else                                                                     :
      ########################################################################
      if                              ( TTE > 360.0                        ) :
        ######################################################################
        if                            ( ( FTL + 360.0 ) < TTE              ) :
          ####################################################################
          return 0
        ######################################################################
      elif                            ( FTL > 360.0                        ) :
        ######################################################################
        if                            ( ( FTL - 360.0 ) < TTE              ) :
          return 0
        ######################################################################
      elif                            ( FTL < TTE                          ) :
        ######################################################################
        return 0
    ##########################################################################
    TLL [ 0 ] = STL
    TLL [ 3 ] = FTL
    ##########################################################################
    T0    = int                       ( Start                                )
    T3    = int                       ( Finish                               )
    FOUND = False
    ##########################################################################
    while                             ( not FOUND                          ) :
      ########################################################################
      dT  = int                       ( T3 - T0                              )
      ########################################################################
      if                              ( dT == 0                            ) :
        return T0
      ########################################################################
      if                              ( dT == 1                            ) :
        return T3
      ########################################################################
      if                              ( dT == 2                            ) :
        return T0 + 1
      ########################################################################
      dT3 = float                     ( float ( dT ) / 3                     )
      T1  = int                       ( T0 + int ( dT3 )                     )
      T2  = int                       ( T3 - int ( dT3 )                     )
      ########################################################################
      NOW . Stardate = T1
      JC  = JulianDayToJulianCentury  ( NOW . toJ2000 ( )                    )
      STL = self . SunTrueLongitudeJC ( JC                                   )
      if                              ( STL < 180.0                        ) :
        STL = float                   ( STL + 360.0                          )
      ########################################################################
      NOW . Stardate = T2
      JC  = JulianDayToJulianCentury  ( NOW . toJ2000 ( )                    )
      FTL = self . SunTrueLongitudeJC ( JC                                   )
      if                              ( FTL < 180.0                        ) :
        FTL = float                   ( FTL + 360.0                          )
      ########################################################################
      TLL [ 1 ] = STL
      TLL [ 2 ] = FTL
      ########################################################################
      TLS [ 1 ] = T1
      TLS [ 2 ] = T2
      ########################################################################
      AT        = 1
      SPOT      = False
      ########################################################################
      while                           ( ( not SPOT ) and ( AT < 4 )        ) :
        ######################################################################
        VV      = TLL                 [ AT                                   ]
        ######################################################################
        if                            ( TTE < 360.0                        ) :
          ####################################################################
          if                          ( VV >= 360.0                        ) :
            ##################################################################
            VV  = float               ( VV - 360.0                           )
        ######################################################################
        if                            ( VV >= TTE                          ) :
          ####################################################################
          SPOT  = True
          ####################################################################
        elif                          ( TLS [ AT ] == TLS [ AT - 1 ]       ) :
          ####################################################################
          return TLS                  [ AT ] + 1
          ####################################################################
        else                                                                 :
          ####################################################################
          AT    = AT + 1
      ########################################################################
      if                              ( not SPOT                           ) :
        ######################################################################
        return 0
      ########################################################################
      T0        = TLS                 [ AT - 1                               ]
      T3        = TLS                 [ AT                                   ]
      ########################################################################
      TLS [ 0 ] = TLS                 [ AT - 1                               ]
      TLS [ 3 ] = TLS                 [ AT                                   ]
      ########################################################################
      TLL [ 0 ] = TLL                 [ AT - 1                               ]
      TLL [ 3 ] = TLL                 [ AT                                   ]
    ##########################################################################
    ## 87661.5265 seconds/degree
    ##########################################################################
    return 0
  ############################################################################
  def FindSolarTerms                      ( self , Start , Finish , TZ     ) :
    ##########################################################################
    TERMs    =                            [                                  ]
    ##########################################################################
    NOW      = StarDate                   (                                  )
    SDT      = int                        ( Start                            )
    NOW      . Stardate = int             ( Start                            )
    JC       = JulianDayToJulianCentury   ( NOW . toJ2000 ( )                )
    STL      = self . SunTrueLongitudeJC  ( JC                               )
    FTL      = float                      ( STL                              )
    ##########################################################################
    BASE     = int ( int ( math.floor ( ( STL + 14.999999 ) / 15.0 ) ) % 24  )
    ##########################################################################
    ## 87661.5265 seconds/degree
    ##########################################################################
    while                                 ( SDT < Finish                   ) :
      ########################################################################
      SANG   = float                      ( float ( BASE ) * 15.0            )
      KANG   = float                      ( SANG                             )
      ########################################################################
      if                                  ( KANG < 180.0                   ) :
        KANG = float                      ( KANG + 360.0                     )
      ########################################################################
      KTL    = float                      ( FTL                              )
      ########################################################################
      if                                  ( KTL  < 180.0                   ) :
        KTL  = float                      ( KTL  + 360.0                     )
      ########################################################################
      dA     = float                      ( KANG - KTL                       )
      ########################################################################
      if                                  ( dA < 0                         ) :
        ######################################################################
        dA   = float                      ( dA + 360.0                       )
      ########################################################################
      DX     = int                        ( dA * 87661.5265                  )
      S1     = int                        ( DX - (  9 * 86400 )              )
      S2     = int                        ( DX + ( 11 * 86400 )              )
      T0     = int                        ( SDT + S1                         )
      T1     = int                        ( SDT + S2                         )
      ########################################################################
      RR     = self . LocateTrueLongitude ( T0 , T1 , SANG                   )
      ########################################################################
      if                                  ( RR == 0                        ) :
        return TERMs
      elif                                ( RR <= Finish                   ) :
        ######################################################################
        NOW  . Stardate = RR
        SET  = NOW . toDateTimeString     ( TZ                               ,
                                            " "                              ,
                                            "%Y/%m/%d"                       ,
                                            "%H:%M:%S"                       )
        ######################################################################
        J    =                            { "Stardate"  : RR                 ,
                                            "DateTime"  : SET                ,
                                            "Term"      : BASE               ,
                                            "Longitude" : SANG               }
        ######################################################################
        TERMs . append                    ( J                                )
      ########################################################################
      SDT    = RR
      FTL    = SANG
      BASE   = int                        ( int ( BASE + 1 ) % 24            )
    ##########################################################################
    return TERMs
  ############################################################################
  ## 地球到太陽的距離
  ############################################################################
  def DistanceToSun                        ( self , Stardate               ) :
    ##########################################################################
    NOW = StarDate                         (                                 )
    NOW . Stardate = Stardate
    ##########################################################################
    JD  = NOW . toJulianDay                (                                 )
    ## UDT = NOW . toDateTimeString           ( "UTC"                           )
    ## OBS = AstroTime                        ( UDT                             )
    OBS = AstroTime                        ( f"{JD}" , format="jd"           )
    PCX = get_body_heliographic_stonyhurst ( "earth" , time = OBS            )
    ##########################################################################
    return float ( 149597870700.0 * float ( PCX . radius . value )           )
  ############################################################################
  ## 尋找區間內的近日點
  ############################################################################
  def FindSunEarthPerihelion          ( self , Start , Finish              ) :
    ##########################################################################
    TLS       =                       { 0 : Start                            ,
                                        1 : 0                                ,
                                        2 : 0                                ,
                                        3 : 0                                ,
                                        4 : 0                                ,
                                        5 : 0                                ,
                                        6 : 0                                ,
                                        7 : 0                                ,
                                        8 : 0                                ,
                                        9 : Finish                           }
    TLL       =                       { 0 : 0.0                              ,
                                        1 : 0.0                              ,
                                        2 : 0.0                              ,
                                        3 : 0.0                              ,
                                        4 : 0.0                              ,
                                        5 : 0.0                              ,
                                        6 : 0.0                              ,
                                        7 : 0.0                              ,
                                        8 : 0.0                              ,
                                        9 : 0.0                              }
    ##########################################################################
    TLL [ 0 ] = self . DistanceToSun  ( Start                                )
    TLL [ 9 ] = self . DistanceToSun  ( Finish                               )
    ##########################################################################
    FOUND     = False
    ##########################################################################
    while                             ( not FOUND                          ) :
      ########################################################################
      T0      = TLS                   [ 0                                    ]
      T9      = TLS                   [ 9                                    ]
      D0      = TLL                   [ 0                                    ]
      D9      = TLL                   [ 9                                    ]
      dT      = int                   ( T9 - T0                              )
      dG      = float                 ( float ( dT ) / 10.0                  )
      AT      = 1
      ########################################################################
      ## 十分法搜尋
      ########################################################################
      while                           ( AT < 9                             ) :
        ######################################################################
        Tn    = int                   ( T0 + int ( dG * AT )                 )
        D     = self . DistanceToSun  ( Tn                                   )
        ######################################################################
        TLS [ AT ] = Tn
        TLL [ AT ] = D
        ######################################################################
        AT    = AT + 1
      ########################################################################
      ## 尋找最小值
      ########################################################################
      AT      = 1
      LOC     = 0
      MIV     = TLL                   [ 0                                    ]
      ########################################################################
      while                           ( AT < 10                            ) :
        ######################################################################
        V     = TLL                   [ AT                                   ]
        ######################################################################
        if                            ( V < MIV                            ) :
          ####################################################################
          LOC = AT
          MIV = V
        ######################################################################
        AT    = AT + 1
      ########################################################################
      if                              ( LOC == 0                           ) :
        ######################################################################
        T0    = TLS                   [ 0                                    ]
        T9    = TLS                   [ 1                                    ]
        ######################################################################
        D0    = TLL                   [ 0                                    ]
        D9    = TLL                   [ 1                                    ]
        ######################################################################
      elif                            ( LOC == 9                           ) :
        ######################################################################
        T0    = TLS                   [ 8                                    ]
        T9    = TLS                   [ 9                                    ]
        ######################################################################
        D0    = TLL                   [ 8                                    ]
        D9    = TLL                   [ 9                                    ]
        ######################################################################
      else                                                                   :
        ######################################################################
        T0    = TLS                   [ LOC - 1                              ]
        T9    = TLS                   [ LOC + 1                              ]
        ######################################################################
        D0    = TLL                   [ LOC - 1                              ]
        D9    = TLL                   [ LOC + 1                              ]
      ########################################################################
      dT      = int                   ( T9 - T0                              )
      ########################################################################
      if                              ( dT < 0                             ) :
        ######################################################################
        dT    = -dT
      ########################################################################
      if                              ( dT == 0                            ) :
        return int                    ( T0                                   )
      ########################################################################
      if                              ( dT == 1                            ) :
        return int                    ( T9                                   )
      ########################################################################
      if                              ( dT == 2                            ) :
        return int                    ( T0 + 1                               )
      ########################################################################
      TLS [ 0 ] = T0
      TLS [ 9 ] = T9
      ########################################################################
      TLL [ 0 ] = D0
      TLL [ 9 ] = D9
    ##########################################################################
    return Start
  ############################################################################
  ## 尋找區間內的遠日點
  ############################################################################
  def FindSunEarthAphelion            ( self , Start , Finish              ) :
    ##########################################################################
    TLS       =                       { 0 : Start                            ,
                                        1 : 0                                ,
                                        2 : 0                                ,
                                        3 : 0                                ,
                                        4 : 0                                ,
                                        5 : 0                                ,
                                        6 : 0                                ,
                                        7 : 0                                ,
                                        8 : 0                                ,
                                        9 : Finish                           }
    TLL       =                       { 0 : 0.0                              ,
                                        1 : 0.0                              ,
                                        2 : 0.0                              ,
                                        3 : 0.0                              ,
                                        4 : 0.0                              ,
                                        5 : 0.0                              ,
                                        6 : 0.0                              ,
                                        7 : 0.0                              ,
                                        8 : 0.0                              ,
                                        9 : 0.0                              }
    ##########################################################################
    TLL [ 0 ] = self . DistanceToSun  ( Start                                )
    TLL [ 9 ] = self . DistanceToSun  ( Finish                               )
    ##########################################################################
    FOUND     = False
    ##########################################################################
    while                             ( not FOUND                          ) :
      ########################################################################
      T0      = TLS                   [ 0                                    ]
      T9      = TLS                   [ 9                                    ]
      D0      = TLL                   [ 0                                    ]
      D9      = TLL                   [ 9                                    ]
      dT      = int                   ( T9 - T0                              )
      dG      = float                 ( float ( dT ) / 10.0                  )
      AT      = 1
      ########################################################################
      ## 十分法搜尋
      ########################################################################
      while                           ( AT < 9                             ) :
        ######################################################################
        Tn    = int                   ( T0 + int ( dG * AT )                 )
        D     = self . DistanceToSun  ( Tn                                   )
        ######################################################################
        TLS [ AT ] = Tn
        TLL [ AT ] = D
        ######################################################################
        AT    = AT + 1
      ########################################################################
      ## 尋找最大值
      ########################################################################
      AT      = 1
      LOC     = 0
      MAV     = TLL                   [ 0                                    ]
      ########################################################################
      while                           ( AT < 10                            ) :
        ######################################################################
        V     = TLL                   [ AT                                   ]
        ######################################################################
        if                            ( V > MAV                            ) :
          ####################################################################
          LOC = AT
          MAV = V
        ######################################################################
        AT    = AT + 1
      ########################################################################
      if                              ( LOC == 0                           ) :
        ######################################################################
        T0    = TLS                   [ 0                                    ]
        T9    = TLS                   [ 1                                    ]
        ######################################################################
        D0    = TLL                   [ 0                                    ]
        D9    = TLL                   [ 1                                    ]
        ######################################################################
      elif                            ( LOC == 9                           ) :
        ######################################################################
        T0    = TLS                   [ 8                                    ]
        T9    = TLS                   [ 9                                    ]
        ######################################################################
        D0    = TLL                   [ 8                                    ]
        D9    = TLL                   [ 9                                    ]
        ######################################################################
      else                                                                   :
        ######################################################################
        T0    = TLS                   [ LOC - 1                              ]
        T9    = TLS                   [ LOC + 1                              ]
        ######################################################################
        D0    = TLL                   [ LOC - 1                              ]
        D9    = TLL                   [ LOC + 1                              ]
      ########################################################################
      dT      = int                   ( T9 - T0                              )
      ########################################################################
      if                              ( dT < 0                             ) :
        ######################################################################
        dT    = -dT
      ########################################################################
      if                              ( dT == 0                            ) :
        return int                    ( T0                                   )
      ########################################################################
      if                              ( dT == 1                            ) :
        return int                    ( T9                                   )
      ########################################################################
      if                              ( dT == 2                            ) :
        return int                    ( T0 + 1                               )
      ########################################################################
      TLS [ 0 ] = T0
      TLS [ 9 ] = T9
      ########################################################################
      TLL [ 0 ] = D0
      TLL [ 9 ] = D9
    ##########################################################################
    return Start
  ############################################################################
  def YearForDistance ( self , Year , TZ                                   ) :
    ##########################################################################
    NOW   = StarDate  (                                                      )
    ##########################################################################
    if                ( Year >= 2000                                       ) :
      ########################################################################
      NOW . fromInput ( f"{Year}-01-01T00:00:00" , TZ                        )
      return NOW . Stardate
    ##########################################################################
    NOW   . fromInput ( "2000-01-01T00:00:00"    , TZ                        )
    CDT   = NOW . Stardate
    ##########################################################################
    return int        ( CDT + int ( 31556925.2522 * float ( Year - 2000 ) )  )
  ############################################################################
  def FindSunEarthPerihelions        ( self , StartYear , FinishYear , TZ  ) :
    ##########################################################################
    TERMs   =                        [                                       ]
    ##########################################################################
    NOW     = StarDate               (                                       )
    YEAR    = int                    ( StartYear                             )
    dT      = int                    ( 90 * 86400                            )
    ##########################################################################
    while                            ( YEAR <= int ( FinishYear )          ) :
      ########################################################################
      YFD   = self . YearForDistance ( YEAR , TZ                             )
      ########################################################################
      SDT   = int                    ( YFD - dT                              )
      FDT   = int                    ( YFD + dT                              )
      ########################################################################
      SEP   = self . FindSunEarthPerihelion ( SDT , FDT                      )
      DIST  = self . DistanceToSun   ( SEP                                   )
      ########################################################################
      NOW   . Stardate = SEP
      SET   = NOW . toDateTimeString ( TZ , " " , "%Y/%m/%d" , "%H:%M:%S"    )
      ########################################################################
      J     =                        { "Year"      : YEAR                    ,
                                       "Distance"  : DIST                    ,
                                       "Stardate"  : SEP                     ,
                                       "DateTime"  : SET                     }
      ########################################################################
      TERMs . append                 ( J                                     )
      ########################################################################
      YEAR  = YEAR + 1
    ##########################################################################
    return TERMs
  ############################################################################
  def FindSunEarthAphelions          ( self , StartYear , FinishYear , TZ  ) :
    ##########################################################################
    TERMs   =                        [                                       ]
    ##########################################################################
    NOW     = StarDate               (                                       )
    YEAR    = int                    ( StartYear                             )
    TS      = int                    (  92 * 86400                           )
    TF      = int                    ( 272 * 86400                           )
    ##########################################################################
    while                            ( YEAR <= int ( FinishYear )          ) :
      ########################################################################
      YFD   = self . YearForDistance ( YEAR , TZ                             )
      ########################################################################
      SDT   = int                    ( YFD + TS                              )
      FDT   = int                    ( YFD + TF                              )
      ########################################################################
      SEP   = self . FindSunEarthAphelion ( SDT , FDT                        )
      DIST  = self . DistanceToSun   ( SEP                                   )
      ########################################################################
      NOW   . Stardate = SEP
      SET   = NOW . toDateTimeString ( TZ , " " , "%Y/%m/%d" , "%H:%M:%S"    )
      ########################################################################
      J     =                        { "Year"      : YEAR                    ,
                                       "Distance"  : DIST                    ,
                                       "Stardate"  : SEP                     ,
                                       "DateTime"  : SET                     }
      ########################################################################
      TERMs . append                 ( J                                     )
      ########################################################################
      YEAR  = YEAR + 1
    ##########################################################################
    return TERMs
##############################################################################
