# -*- coding: utf-8 -*-
##############################################################################
## 決策行動元件
##############################################################################
import os
import sys
import time
import datetime
from   threading import Thread
from   threading import Lock
##############################################################################
class Action             (                                                 ) :
  ############################################################################
  def __init__           ( self , uuid                                     ) :
    self . Uuid   = uuid
    self . locker = Lock (                                                   )
    self . clear         (                                                   )
    return
  ############################################################################
  def __del__ ( self                                                       ) :
    return
  ############################################################################
  ## 檢查是否為相同的決策行動元件
  ############################################################################
  def __eq__              ( self , another                                 ) :
    return self . isEqual (        another                                   )
  ############################################################################
  ## 檢查是否為相同的決策行動元件
  ############################################################################
  def isEqual ( self , another                                             ) :
    return    ( self . Uuid == another . Uuid                                )
  ############################################################################
  ## 決策行動名稱
  ############################################################################
  def name                    ( self                                       ) :
    raise NotImplementedError (                                              )
  ############################################################################
  ## 清除決策行動元件
  ############################################################################
  def clear                 ( self                                         ) :
    ##########################################################################
    self . locker . acquire (                                                )
    ##########################################################################
    self . arguments  =     {                                                }
    self . conditions =     {                                                }
    ##########################################################################
    self . locker . release (                                                )
    ##########################################################################
    return
  ############################################################################
  ## 條件編號列表
  ############################################################################
  def keys                          ( self                                 ) :
    return self . conditions . keys (                                        )
  ############################################################################
  ## 新增條件元件
  ############################################################################
  def addCondition          ( self , condition                             ) :
    ##########################################################################
    self . locker . acquire (                                                )
    ##########################################################################
    self . conditions [ condition . Uuid ] = condition
    condition . addAction   ( self                                           )
    ##########################################################################
    self . locker . release (                                                )
    ##########################################################################
    return
  ############################################################################
  ## 新增條件元件群
  ############################################################################
  def addConditions         ( self , conditions                            ) :
    ##########################################################################
    self . locker . acquire (                                                )
    ##########################################################################
    for c in conditions                                                      :
      self . conditions [ c . Uuid ] = c
      c . addAction         ( self                                           )
    ##########################################################################
    self . locker . release (                                                )
    ##########################################################################
    return
  ############################################################################
  ## 移除條件元件
  ############################################################################
  def removeCondition       ( self , uuid                                  ) :
    ##########################################################################
    self . locker . acquire (                                                )
    ##########################################################################
    if                      ( uuid in self . conditions                    ) :
      self . conditions [ uuid ] . removeAction ( self                       )
      del self . conditions [ uuid                                           ]
    ##########################################################################
    self . locker . release (                                                )
    ##########################################################################
    return
  ############################################################################
  ## 全部為真
  ############################################################################
  def isTrue                    ( self                                     ) :
    ##########################################################################
    self . locker . acquire     (                                            )
    ##########################################################################
    Keys = self . keys          (                                            )
    for k in Keys                                                            :
      ########################################################################
      if                        ( not self . conditions [ k ] . value ( )  ) :
        ######################################################################
        self . locker . release (                                            )
        return False
    ##########################################################################
    self . locker . release     (                                            )
    ##########################################################################
    return True
  ############################################################################
  ## 全部為假
  ############################################################################
  def isFalse                   ( self                                     ) :
    ##########################################################################
    self . locker . acquire     (                                            )
    ##########################################################################
    Keys = self . keys          (                                            )
    for k in Keys                                                            :
      ########################################################################
      if                        ( self . conditions [ k ] . value ( )      ) :
        ######################################################################
        self . locker . release (                                            )
        return False
    ##########################################################################
    self . locker . release     (                                            )
    ##########################################################################
    return True
  ############################################################################
  ## 執行決策行動
  ############################################################################
  def Execute ( self                                                       ) :
    return False
##############################################################################
